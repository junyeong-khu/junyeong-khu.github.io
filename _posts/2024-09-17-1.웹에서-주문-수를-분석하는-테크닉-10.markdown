---
layout: post
title: "íŒŒì´ì¬ ë°ì´í„°ë¶„ì„ ì‹¤ë¬´ í…Œí¬ë‹‰ 100 : 1. ì›¹ì—ì„œ ì£¼ë¬¸ ìˆ˜ë¥¼ ë¶„ì„í•˜ëŠ” í…Œí¬ë‹‰ 10"
date: 2024-09-17 03:01:45 +0900
categories: íŒŒì´ì¬_ë°ì´í„°ë¶„ì„_ì‹¤ë¬´_í…Œí¬ë‹‰_100
---
## <span style= 'background-color: #f1f8ff'>1-0: ì „ì œì¡°ê±´
ğŸ’¡ ì´ ì¥ì—ì„œ ì†Œê°œí•˜ëŠ” 10ê°œ í…Œí¬ë‹‰ì—ì„œëŠ” ì‡¼í•‘ëª° ì‚¬ì´íŠ¸ì˜ ë°ì´í„°ë¥¼ ë‹¤ë£¹ë‹ˆë‹¤. ì´ ì‡¼í•‘ëª°ì˜ ì£¼ìš” í’ˆëª©ì€ ì»´í“¨í„°ì…ë‹ˆë‹¤. ê°€ê²©ëŒ€ë³„ë¡œ 5ê°œì˜ ìƒí’ˆì´ ì¡´ì¬í•©ë‹ˆë‹¤. ë°ì´í„°ëŠ” 4ì¢…ë¥˜ì˜ 6ê°œ ë°ì´í„°ë¡œ í‘œ 1-1ê³¼ ê°™ìŠµë‹ˆë‹¤.
customer_master.csvëŠ” ì´ ì‡¼í•‘ëª° ì‚¬ì´íŠ¸ì˜ ê³ ê° ì •ë³´ì…ë‹ˆë‹¤. ì‡¼í•‘ëª° ì‚¬ì´íŠ¸ ë“±ì„ ì´ìš©í•  ë•Œ íšŒì› ë“±ë¡ ì‹œ ì…ë ¥í•˜ëŠ” ì •ë³´ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. item_master.csvëŠ” ì·¨ê¸‰í•˜ëŠ” ìƒí’ˆ ë°ì´í„°ë¡œ, ìƒí’ˆëª…ê³¼ ê°€ê²©ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
transaction_1.csvì™€ transaction_2.csvëŠ” êµ¬ë§¤ë‚´ì—­ ë°ì´í„°ì…ë‹ˆë‹¤. ì–¸ì œ, ì–´ëŠ ê³ ê°ì´ ì–¼ë§ˆë‚˜ ìƒ€ëŠ”ì§€ì˜ ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.
transaction_detail_1.csv, transaction_detail_2.csvëŠ” êµ¬ë§¤ë‚´ì—­ ìƒì„¸ ë°ì´í„°ì…ë‹ˆë‹¤. êµ¬ì²´ì ìœ¼ë¡œ ì–´ë–¤ ìƒí’ˆì„ ëª‡ ê°œ ìƒ€ëŠ”ì§€ì˜ ì •ë³´ê°€ ë“¤ì–´ ìˆìŠµë‹ˆë‹¤. ë°ì´í„°ë² ì´ìŠ¤ì— ë“¤ì–´ ìˆëŠ” ë°ì´í„°ë¥¼ ì‹œìŠ¤í…œì—ì„œ ê°€ì ¸ì˜¬ ë•ŒëŠ” ì›”ë³„ì´ë‚˜ 1,000ê±´ ë‹¨ìœ„ë¡œ ë¶í• í•˜ëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤. ì´ ê²½ìš°, ë°ì´í„°ë¥¼ ê²°í•©í•´ì„œ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. ì´ ìƒì„¸ ë°ì´í„°ë„ ì—¬ê¸°ì— í•´ë‹¹í•˜ë©° 1ê³¼ 2, ë‘ ê°œê°€ ì¡´ì¬í•©ë‹ˆë‹¤.

í‘œ 1-1
![image](https://github.com/user-attachments/assets/8b6b9b41-5a6a-4e01-9b29-b62c0cdc19de)

## <span style= 'background-color: #f1f8ff'>1-1: ë°ì´í„°ë¥¼ ì½ì–´ ë“¤ì´ì
ğŸ—ƒï¸ ë°ì´í„° ë¦¬ë”©
```python
import pandas as pd
customer_master = pd.read_csv('customer_master.csv')
customer_master.head() #ì²˜ìŒ 5í–‰ í‘œì‹œ
```
ğŸ” ì‹¤ì œ í˜„ì¥ì—ì„œëŠ” ë¨¼ì € ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•œ í›„ ë°ì´í„°ì˜ ê°œìš”ë¥¼ íŒŒì•…í•˜ê³  ë‚˜ì„œ ë¶„ì„ì— ì ì ˆí•œ í˜•íƒœë¡œ ê°€ê³µí•˜ëŠ” ê²½ìš°ê°€ ë§ìŒ. ë”°ë¼ì„œ ì—¬ëŸ¬ ê°œì˜ íŒŒì¼ì— ë°ì´í„°ê°€ í©ì–´ì ¸ ìˆëŠ” ê²½ìš°ë¥¼ ë‹¤ë£¨ëŠ” ê²ƒì— ìµìˆ™í•´ì ¸ì•¼ í•¨!

ğŸ” ì¶”ìƒì  ëª©ì ì´ë“  êµ¬ì²´ì  ëª©ì ì´ë“  ë¨¼ì € ë°ì´í„° ì „ì²´ë¥¼ íŒŒì•…í•˜ëŠ” ê²ƒì´ ì¤‘ìš” => ìƒì„¸í•œ ë°ì´í„°ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë°ì´í„°ë¥¼ ê°€ê³µí•˜ëŠ” ê²ƒì´ ì¤‘ìš”

## <span style= 'background-color: #f1f8ff'>1-2: ë°ì´í„°ë¥¼ ê²°í•©(ìœ ë‹ˆì–¸)í•´ ë³´ì
ğŸ—ƒï¸ ë°ì´í„° ìœ ë‹ˆì–¸
```python
#í•„ìš”í•œ csv íŒŒì¼ì€ ì´ë¯¸ ì½ì–´ì™”ë‹¤ ê°€ì •
transaction = pd.concat([transaction_1, transaction_2], ignore_index=True) #ë°ì´í„°ë¥¼ í–‰ ë°©í–¥ìœ¼ë¡œ ê²°í•©(ìœ ë‹ˆì–¸)
```

ğŸ—ƒï¸ ìœ ë‹ˆì–¸ ê²°ê³¼ í™•ì¸
```python
print(len(transaction_1))
print(len(transaction_2))
print(len(transaction))
```
â¡ï¸
5000, 1786, 6786

ğŸ” í–‰ ë°©í–¥ìœ¼ë¡œ ê²°í•©(ìœ ë‹ˆì–¸)í–ˆê¸°ì— ì²˜ìŒ 5í–‰ í‘œì‹œë¡œëŠ” ê²°í•©ì´ ì œëŒ€ë¡œ ëëŠ”ì§€ í™•ì¸í•  ìˆ˜ ì—†ìŒ. ë”°ë¼ì„œ len ëª…ë ¹ì–´ë¡œ ê° íŒŒì¼ë“¤ì˜ ì„¸ë¡œ ê¸¸ì´ë¥¼ íŒŒì•…í•˜ì—¬ ê²°í•©ì´ ì œëŒ€ë¡œ ëëŠ”ì§€ í™•ì¸í•¨.

## <span style= 'background-color: #f1f8ff'>1-3: ë§¤ì¶œ ë°ì´í„°ë¼ë¦¬ ê²°í•©(ì¡°ì¸)í•´ ë³´ì
ğŸ” ë°ì´í„°ë¥¼ ì¡°ì¸í•  ë•Œ â€ë¶€ì¡±í•œ ë°ì´í„° ì¹¼ëŸ¼ì´ ë¬´ì—‡ì¸ê°€ì™€ âê³µí†µë˜ëŠ” ë°ì´í„° ì¹¼ëŸ¼ì€ ë¬´ì—‡ì¸ê°€ ìƒê°í•´ì•¼í•¨. 

ğŸ—ƒï¸ ë°ì´í„° ì¡°ì¸
```python
join_data = pd.merge(transaction_detail, transaction[["transaction_id", "payment_date", "customer_id"]], on="transaction_id", how="left")
#transaction_detailê³¼ transactionì„ ì¡°ì¸. transactionì˜ ì„¸ ì»¬ëŸ¼ì„ ì¡°ì¸ì‹œí‚´.
#onì„ ì§€ì •í•˜ì—¬ ê³µí†µ ì»¬ëŸ¼ì¸ transaction_idë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¡°ì¸í•¨.
#howë¥¼ ì§€ì •í•˜ì—¬ ë ˆí”„íŠ¸ ì¡°ì¸ìœ¼ë¡œ ì„¤ì •. ì™¼ìª½ ë°ì´í„°ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ì˜¤ë¥¸ìª½ ë°ì´í„°ê°€ ê²°í•©ë¨.
join_data.head()
```

ğŸ—ƒï¸ ì¡°ì¸ ê²°ê³¼ í™•ì¸
```python
print(len(transaction_detail))
print(len(transaction))
print(len(join_data))
```
â¡ï¸
7144, 6786, 7144

ğŸ” ì¦‰, transaction_detailê³¼ join_dataì˜ ì„¸ë¡œ ê¸¸ì´ê°€ ê°™ì€ ê²ƒìœ¼ë¡œ ë³´ì•„ ê°€ë¡œë¡œ ë°ì´í„°ê°€ ëŠ˜ì–´ë‚˜ì„œ ì¡°ì¸ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŒ.

## <span style= 'background-color: #f1f8ff'>1-4: ë§ˆìŠ¤í„°ë°ì´í„°ë¥¼ ê²°í•©(ì¡°ì¸)í•´ ë³´ì
ğŸ—ƒï¸ ë§ˆìŠ¤í„°ë°ì´í„° ì¡°ì¸
```python
join_data = pd.merge(join_data, customer_master, on="customer_id", how="left")
join_data = pd.merge(join_data, item_master, on="item_id", how="left")
join_data.head()
```

## <span style= 'background-color: #f1f8ff'>1-5: í•„ìš”í•œ ë°ì´í„° ì¹¼ëŸ¼ì„ ë§Œë“¤ì
ğŸ—ƒï¸ ë°ì´í„° ì¹¼ëŸ¼ ìƒì„±
```python
join_data["price"] = join_data["quantity"] * join_data["item_price"]
join_data[["quantity", "item_price", "price"]].head()
```

ğŸ” ë°ì´í„°í”„ë ˆì„í˜• ê³±ì…ˆì€ í–‰ë§ˆë‹¤ ê³„ì‚°ì´ ì‹¤í–‰ë¨.

ğŸ” ì˜ëª»ëœ ë°ì´í„° ì œê³µì€ íšŒì‚¬ì˜ ê²½ì˜ì— ë§‰ëŒ€í•œ ì˜í–¥ì„ ë¯¸ì¹˜ë©° ìµœì•…ì˜ ê²½ìš° íšŒì‚¬ë¥¼ ë§í•˜ê²Œ í•  ìˆ˜ë„ ìˆìŒ. ë˜í•œ ê³ ê°ì˜ ì‹ ë¢°ë¥¼ ìƒê¸° ì‰¬ì›€. ë”°ë¼ì„œ ë°ì´í„°ë¥¼ ê²°í•©í•  ë•ŒëŠ” ì‹ ì¤‘íˆ ê°œìˆ˜ë¥¼ í™•ì¸í•´ì•¼í•˜ë©° ê²€ì‚°ì´ ê°€ëŠ¥í•œ ë°ì´í„° ì¹¼ëŸ¼ì„ ì°¾ê³  ê³„ì‚°í•´ì•¼í•¨.

## <span style= 'background-color: #f1f8ff'>1-6: ë°ì´í„°ë¥¼ ê²€ì‚°í•˜ì
ğŸ—ƒï¸ ë°ì´í„° ê²€ì‚°
```python
#ë°©ë²• 1
print(join_data["price"].sum())
print(transaction["price"].sum())

#ë°©ë²• 2
join_data["price"].sum() == transaction["price"].sum()
```
â¡ï¸
971135000, 971135000, True

## <span style= 'background-color: #f1f8ff'>1-7: ê°ì¢… í†µê³„ëŸ‰ì„ íŒŒì•…í•˜ì
ğŸ” ë°ì´í„° ë¶„ì„ì„ ì§„í–‰í•  ë•ŒëŠ” â€ê²°ì†ì¹˜ì˜ ê°œìˆ˜, âì „ì²´ë¥¼ íŒŒì•…í•  ìˆ˜ ìˆëŠ” ìˆ«ìê°ì„ íŒŒì•…í•´ì•¼í•¨.

ğŸ—ƒï¸ ê²°ì†ì¹˜ íŒŒì•…
```python
join_data.isnull().sum()
#isnullì€ ê²°ì†ì¹˜ê°€ True/Falseë¡œ ë°˜í™˜í•¨.
#sumìœ¼ë¡œ Trueì˜ ê°œìˆ˜ë¥¼ ì»¬ëŸ¼ë§ˆë‹¤ ê³„ì‚°í•˜ì—¬ ê²°ì†ì¹˜ì˜ ê°œìˆ˜ë¥¼ íŒŒì•…í•¨.
```
â¡ï¸
![image](https://github.com/user-attachments/assets/36c5d108-3e4e-4b4c-8813-e1b306673136)

ğŸ—ƒï¸ ì „ì²´ ìˆ«ìê° íŒŒì•…
```python
join_data.describe()
#describeëŠ” ë°ì´í„° ê°œìˆ˜, í‰ê· ê°’, í‘œì¤€í¸ì°¨, ìµœì†Ÿê°’, ì‚¬ë¶„ìœ„ìˆ˜, ì¤‘ì•™ê°’, ìµœëŒ“ê°’ ì¶œë ¥
```
â¡ï¸
![image](https://github.com/user-attachments/assets/5439c568-b23d-4b90-92a8-04b297d5ecff)

ğŸ—ƒï¸ ë°ì´í„° ê¸°ê°„ íŒŒì•…
```python
print(join_data["payment_date"].min())
print(join_data["payment_date"].max())
```
â¡ï¸
2019.02.01, 2019.07.31

## <span style= 'background-color: #f1f8ff'>1-8: ì›”ë³„ë¡œ ë°ì´í„°ë¥¼ ì§‘ê³„í•´ ë³´ì
ğŸ” ë°ì´í„°ì˜ ê¸°ê°„ì´ ê¸¸ì–´ì§€ë©´ ì—¬ëŸ¬ê°€ì§€ ë¹„ì¦ˆë‹ˆìŠ¤ ëª¨ë¸ì´ í¬í•¨ë˜ì–´ ìˆì„ ìˆ˜ ìˆê¸°ì— ì „ì²´ ë°ì´í„°ë¥¼ í•œ ë²ˆì— ë¶„ì„í•  ê²½ìš° ë°ì´í„°ì˜ ì‹œê³„ì—´ ë³€í™”ë¥¼ ì˜ëª» íŒŒì•…í•˜ëŠ” ê²½ìš°ê°€ ìˆìŒ. => ë°ì´í„° ë²”ìœ„ë¥¼ ì¢í˜€ì„œ ë¶„ì„!

ğŸ—ƒï¸ ë°ì´í„°í˜• í™•ì¸
```python
join_data.dtypes
```
â¡ï¸
![image](https://github.com/user-attachments/assets/fa3ccf8e-ffbe-49c3-8b82-bbe8054cd0d7)

ğŸ—ƒï¸ ë°ì´í„°í˜• ë³€í™˜
```python
join_data["payment_date"] = pd.to_datetime(join_data["payment_date"])
join_data["payment_month"] = join_data["payment_date"].dt.strftime("%Y%m") #ë…„, ì›” ì¶”ì¶œ
join_data[["payment_date", "payment_month"]].head()
```
â¡ï¸
![image](https://github.com/user-attachments/assets/ca24a901-7b4f-4da9-820f-a2071fd444bc)

ğŸ—ƒï¸ ì›”ë³„ ë°ì´í„° ì§‘ê³„
```python
join_data.groupby("payment_month").sum()["price"]
```
â¡ï¸
![image](https://github.com/user-attachments/assets/8e3118ed-53a8-425a-97e0-95e2a2f4def8)

## <span style= 'background-color: #f1f8ff'>1-9: ì›”ë³„, ìƒí’ˆë³„ë¡œ ë°ì´í„°ë¥¼ ì§‘ê³„í•´ ë³´ì
ğŸ—ƒï¸ ì›”ë³„, ìƒí’ˆë³„ ë°ì´í„° ì§‘ê³„ 1
```python
join_data.groupby(["payment_month","item_name"]).sum()[["price", "quantity"]]
```
â¡ï¸
![image](https://github.com/user-attachments/assets/4555f877-99da-4162-9342-12245ec9e04f)

ğŸ—ƒï¸ ì›”ë³„, ìƒí’ˆë³„ ë°ì´í„° ì§‘ê³„ 2
```python
pd.pivot_table(join_data, index='item_name', columns='payment_month', values=['price', 'quantity'], aggfunc='sum')
#indexë¥¼ item_name, columnsë¥¼ payment_monthë¡œ ì§€ì •í•˜ì—¬ í–‰ê³¼ ì¹¼ëŸ¼ì„ ì§€ì •.
#valuesë¥¼ ì§€ì •í•˜ì—¬ ì§‘ê³„í•˜ê³  ì‹¶ì€ ì¹¼ëŸ¼ì„ ì„¤ì •.
#aggfuncë¡œ ì§‘ê³„ ë°©ë²•ì„ ì„¤ì •.
```
â¡ï¸
![image](https://github.com/user-attachments/assets/ef67b432-a194-41e6-b911-6b84b5b8fc4f)

## <span style= 'background-color: #f1f8ff'>1-10: ìƒí’ˆë³„ ë§¤ì¶œ ì¶”ì´ë¥¼ ê°€ì‹œí™”í•´ ë³´ì
ğŸ—ƒï¸ ë°ì´í„° ì§‘ê³„
```python
graph_data = pd.pivot_table(join_data, index='payment_month', columns='item_name', values='price', aggfunc='sum')
```

ğŸ—ƒï¸ ê·¸ë˜í”„ ì‘ì„±
```python
import matplotlib.pyplot as plt
&matplotlib inline #ì£¼í”¼í„° ë…¸íŠ¸ë¶ì— í‘œì‹œí•˜ê¸° ìœ„í•œ ì½”ë“œ.
plt.plot(list(graph_data.index), graph_data["PC-A"], label='PC-A')
plt.plot(list(graph_data.index), graph_data["PC-B"], label='PC-B')
plt.plot(list(graph_data.index), graph_data["PC-C"], label='PC-C')
plt.plot(list(graph_data.index), graph_data["PC-D"], label='PC-D')
plt.plot(list(graph_data.index), graph_data["PC-E"], label='PC-E')
plt.legend() #ë²”ë¡€ í‘œì‹œ
```
â¡ï¸
![image](https://github.com/user-attachments/assets/50efcf0b-23e7-4034-9ec9-d7af4daa07c8)


### ì¶œì²˜ : íŒŒì´ì¬ ë°ì´í„°ë¶„ì„ ì‹¤ë¬´ í…Œí¬ë‹‰ 100