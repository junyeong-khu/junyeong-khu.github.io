---
layout: post
title: "íŒŒì´ì¬ ë°ì´í„°ë¶„ì„ ì‹¤ë¬´ í…Œí¬ë‹‰ 100 : 9. ì ì¬ê³ ê°ì„ íŒŒì•…í•˜ê¸° ìœ„í•œ ì´ë¯¸ì§€ ì¸ì‹ í…Œí¬ë‹‰ 10"
date: 2024-10-31 03:01:45 +0900
categories: íŒŒì´ì¬_ë°ì´í„°ë¶„ì„_ì‹¤ë¬´_í…Œí¬ë‹‰_100
---
## <span style= 'background-color: #f1f8ff'>ê³ ê°ì˜ ì†Œë¦¬
ğŸ—£ï¸ ìš°ë¦¬ê°€ ìš´ì˜í•˜ëŠ” ëŒ€ë¦¬ì ì— ì¹´ë©”ë¼ë¥¼ ì„¤ì¹˜í•˜ê³  ì´¬ì˜í•´ ë´¤ìŠµë‹ˆë‹¤. ì‹œê°„ëŒ€ì— ë”°ë¼ ì‚¬ëŒì˜ ì™•ë˜ê°€ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— ë¶„ì„í•˜ë©´ ì¬ë¯¸ìˆì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤ë§Œ, ìš°ë¦¬ëŠ” ì´ë¯¸ì§€ë¥¼ ì–´ë–»ê²Œ ë¶„ì„í•˜ëŠ”ì§€ ì „í˜€ ì•Œì§€ ëª»í•©ë‹ˆë‹¤. ë˜, ì´ë¯¸ì§€ì—ì„œ ì–´ë–¤ ì •ë³´ë¥¼ ì–»ì„ ìˆ˜ ìˆëŠ”ì§€ë„ ëª¨ë¥´ê¸° ë•Œë¬¸ì— ì–´ë–»ê²Œ í™œìš©í•´ì•¼ í• ì§€ ëª¨ë¥´ê² ìŠµë‹ˆë‹¤. í™œìš©í•  ìˆ˜ ìˆëŠ” ì¢‹ì€ ë°©ë²•ì„ ì œì•ˆí•´ì£¼ì„¸ìš”.


## <span style= 'background-color: #f1f8ff'>9-0: ì „ì œì¡°ê±´
ğŸ’¡ ì´ ì¥ì˜ 10ê°œ í…Œí¬ë‹‰ì€ ëŒ€ë¦¬ì  ì• ë„ë¡œì˜ ë™ì˜ìƒ/ì´ë¯¸ì§€ë¥¼ ë‹¤ë£¹ë‹ˆë‹¤. ë™ì˜ìƒì€ mov í´ë”ì—, ì´ë¯¸ì§€ëŠ” img í´ë”ì— ê°ê° ì €ì¥ë¼ ìˆìŠµë‹ˆë‹¤. ë˜ ë™ì˜ìƒì„ ì´ë¯¸ì§€í™”í•œ ê²ƒ(ìŠ¤ëƒ…ìˆ)ì„ ì €ì¥í•  ë¹ˆ í´ë” snapshotì„ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤. ë™ì˜ìƒ íŒŒì¼ì¸ avië¥¼ macì—ì„œ ë³¼ ë•Œ ê¸°ë³¸ìœ¼ë¡œ íƒ‘ì¬ëœ ì†Œí”„íŠ¸ì›¨ì–´ë¡œëŠ” ë³¼ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ë³„ë„ì˜ ì¬ìƒ ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ë‚´ë ¤ë°›ì•„ì•¼ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
![image](https://github.com/user-attachments/assets/406fddec-10c4-4054-b7f3-d6820bd8aaad)


## <span style= 'background-color: #f1f8ff'>9-1: ì´ë¯¸ì§€ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì
ğŸ—ƒï¸ ì´ë¯¸ì§€ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
```python
import cv2
img = cv2.imread("img/img01.jpg")
height, width = img.shape[:2] #ì´ë¯¸ì§€ ì •ë³´ ì¶”ì¶œ. ë†’ì´ì™€ ë„ˆë¹„ë§Œ ê°€ì ¸ì˜´.
print("ì´ë¯¸ì§€ ê°€ë¡œ: " + str(width))
print("ì´ë¯¸ì§€ ì„¸ë¡œ: " + str(height))
cv2.imshow("img",img)
cv2.waitKey(0) #ì´ë¯¸ì§€ë¥¼ í‘œì‹œí•  ì‹œê°„ ì§€ì •. 0ì´ë©´ ìœˆë„ìš°ë¥¼ ë‹«ì„ ë•Œê¹Œì§€ ê³„ì†í•´ì„œ ë³´ì—¬ì¤Œ.
```
ì´ë¯¸ì§€ ê°€ë¡œ: 1920\
ì´ë¯¸ì§€ ì„¸ë¡œ: 1440

![image](https://github.com/user-attachments/assets/1b2a4833-d1eb-48c4-baec-a361395a7135)


## <span style= 'background-color: #f1f8ff'>9-2: ë™ì˜ìƒ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì
ğŸ—ƒï¸ ë™ì˜ìƒ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
```python
import cv2

#ì •ë³´ ì·¨ë“
cap = cv2.VideoCapture("mov/mov01.avi")
width = cap.get(cv2.CAP_PROP_FRAME_WIDTH)
heigth = cap.get(cv2.CAP_PROP_FRAME_HEIGHT)
count = cap.get(cv2.CAP_PROP_FRAME_COUNT)
fps = cap.get(cv2.CAP_PROP_FPS)
print("ê°€ë¡œ: " + str(width))
print("ì„¸ë¡œ: " + str(height))
print("ì´ í”„ë ˆì„ìˆ˜: " + str(count))
print("FPS: " + str(fps))

#ì¶œë ¥
while(cap.isOpened()): #capì´ ì—´ë ¤ìˆëŠ” ë™ì•ˆ ë°˜ë³µ.
    ret, frame = cap.read() #ë¹„ë””ì˜¤ì—ì„œ í”„ë ˆì„ì„ ì½ìŒ. retì€ í”„ë ˆì„ì„ ì„±ê³µì ìœ¼ë¡œ ì½ì—ˆëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë¶ˆë¦¬ì–¸ ê°’.
    if ret: #í”„ë ˆì„ì´ ì„±ê³µì ìœ¼ë¡œ ì½í˜”ì„ ê²½ìš°
        cv2.imshow("frame", frame) #frame ì°½ì— ì½ì€ í”„ë ˆì„ì„ í‘œì‹œ.
    if cv2.waitKey(1) & 0xFF == ord("q"): #ê° í”„ë ˆì„ì„ 1ë°€ë¦¬ì´ˆ ë™ì•ˆ í‘œì‹œí•˜ê³ , ëª¨ë“  í”„ë ˆì„ì„ ì²˜ë¦¬í•˜ê±°ë‚˜ qí‚¤ë¥¼ í´ë¦­í•˜ë©´ ì¢…ë£Œ.
        break
cap.realease() #ë¹„ë””ì˜¤ ìº¡ì²˜ ê°ì²´ í•´ì œ.
cv2.destroyAllWindows() #ëª¨ë“  ì°½ì„ ë‹«ìŒ.
```
ê°€ë¡œ: 1920.0\
ë†’ì´: 1440.0\
ì´ í”„ë ˆì„ ìˆ˜: 401.0\
FPS: 30.0

![image](https://github.com/user-attachments/assets/1b2a4833-d1eb-48c4-baec-a361395a7135)

ğŸ” ë™ì˜ìƒì„ ì—¬ëŸ¬ ê°œì˜ ì´ë¯¸ì§€(í”„ë ˆì„)ë¡œ ìº¡ì²˜í•˜ì—¬ imshowë¥¼ í†µí•´ í•˜ë‚˜ì”© ë³´ì—¬ì£¼ì–´ ë™ì˜ìƒì²˜ëŸ¼ ë³´ì—¬ì£¼ëŠ” ê³¼ì •.


## <span style= 'background-color: #f1f8ff'>9-3: ë™ì˜ìƒì„ ì´ë¯¸ì§€ë¡œ ë‚˜ëˆ„ê³  ì €ì¥í•˜ì
ğŸ—ƒï¸ ìº¡ì²˜ ì´ë¯¸ì§€ ì €ì¥
```python
cap = cv2.VideoCapture("mov/mov01.avi")
num = 0
while(cap.isOpened()):
    ret, frame = cap.read()
    if ret:
        cv2.imshow("frame", frame)
        filepath = "snapshot/snapshot_" + str(num) + ".jpg"
        cv2.imwrite(filepath,frame)
        if cv2.waitKey(1) & 0xFF == ord('q'):
            break
    num = num + 1
cap.realease()
cv2.destroyAllWindows()
```
![image](https://github.com/user-attachments/assets/95f8cb03-2b63-4a6a-abed-705d66b971f8)

ğŸ” cv2.imwrite(A, B): AëŠ” íŒŒì¼ ê²½ë¡œ, BëŠ” ì €ì¥í•  ì´ë¯¸ì§€ë¥¼ ì˜ë¯¸.


## <span style= 'background-color: #f1f8ff'>9-4: ì´ë¯¸ì§€ ì†ì— ì‚¬ëŒì´ ì–´ë””ì— ìˆëŠ”ì§€ ê²€ì¶œí•´ ë³´ì
ğŸ—ƒï¸ ì‚¬ëŒ ê²€ì¶œ: ì‚¬ì „ì— í•™ìŠµëœ ëª¨ë¸ì„ ì‚¬ìš©. ì‚¬ê°í˜•ì„ ê·¸ë¦¬ëŠ” í•¨ìˆ˜ë¥¼ í†µí•´ ì–´ëŠ ìœ„ì¹˜ì˜ ì‚¬ëŒì„ ê²€ì¶œí–ˆëŠ”ì§€ í™•ì¸.
```python
#ì¤€ë¹„
hog = cv2.HOGDescriptor()
hog.setSVMDetector(cv2.HOGDescriptor_getDefaultPeopleDetector())
hogParams = {'winStride': (8, 8), 'padding': (32, 32), 'scale': 1.05, 'hitThreshold': 0, 'finalThreshold': 5}

#ê²€ì¶œ
img = cv2.imread("img/img01.jpg")
gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
human, r = hog.detectMultiScale(gray, **hogParmas)
if (len(human)>0):
    for (x, y, w, h) in human:
        cv2.rectangle(img, (x, y), (x + w, y + h), (255,255,255), 3)
cv2.namedWindow("img",cv2.WINDOW_NORMAL)
cv2.imshow("img",img)
cv2.imwrite("temp.jpg",img)
cv2.waitKey(0)
cv2.destroyAllWindows()
```
![image](https://github.com/user-attachments/assets/00bc7004-9511-4fdd-9726-3b1e7205fb67)


ğŸ” HOG íŠ¹ì§•ëŸ‰: Histogram of Oriented Gradientsì˜ ì•½ìë¡œ íœ˜ë„ì˜ ê¸°ìš¸ê¸°ë¥¼ ì˜ë¯¸. ì‚¬ëŒ ì‹¤ë£¨ì—£ í˜•íƒœì˜ íŠ¹ì§•ì„ ìœ„ì¹˜ë‚˜ ê°ë„ë¡œ í‘œí˜„í•œ ê²ƒ. ì´ë¥¼ í†µí•´ ì‚¬ëŒì„ ê°„ë‹¨í•˜ê²Œ ì¸ì‹í•  ìˆ˜ ìˆìŒ.


ğŸ” ì•½ê°„ì˜ ì˜¤ê²€ì¶œì´ ìˆì§€ë§Œ í†µê³„ì ì¸ ê²½í–¥ì„ íŒŒì•…í•˜ëŠ” ë°ëŠ” ì¶©ë¶„íˆ ì´ìš© ê°€ëŠ¥.


## <span style= 'background-color: #f1f8ff'>9-5: ì´ë¯¸ì§€ ì† ì‚¬ëŒ ì–¼êµ´ì„ ê²€ì¶œí•´ ë³´ì
ğŸ—ƒï¸ ì‚¬ëŒ ì–¼êµ´ ê²€ì¶œ: ì‚¬ì „ì— í•™ìŠµëœ ëª¨ë¸ì„ ì‚¬ìš©.
```python
#ì¤€ë¹„
cascade_file = "haarcascade_frontalface_alt.xml"
cascade = cv2.CascadeClassifier(cascade_file)

#ê²€ì¶œ
img = cv2.imread("img/img02.jpg")
gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
face_list = cascade.detectMultiScale(gray, minSize=(50, 50))

#ê²€ì¶œí•œ ì–¼êµ´ í‘œì‹œ
for (x, y, w, h) in face_list:
    color = (0, 0, 225)
    pen_w = 3
    cv2.rectangle(img, (x, y), (x+w, y+h), color, thickness = pen_w)

cv2.namedWindow("img",cv2.WINDOW_NORMAL)
cv2.imshow("img",img)
cv2.imwrite("temp.jpg",img)
cv2.waitKey(0)
cv2.destroyAllWindows()
```
![image](https://github.com/user-attachments/assets/3613ad59-476a-4c0b-a299-442286468d94)

ğŸ” ì´ë²ˆ ì½”ë“œì—ì„œëŠ” ì •ë©´ ì–¼êµ´ì„ ì¸ì‹í•˜ëŠ” ëª¨ë¸ë§Œì„ ì‚¬ìš©í•´ì„œ ìœ„ ì‚¬ì§„ì˜ ì™¼ìª½ ì—¬ì„±ì˜ ì–¼êµ´ì€ ì¸ì‹í•˜ì§€ ëª»í•¨.


## <span style= 'background-color: #f1f8ff'>9-6: ì´ë¯¸ì§€ ì† ì‚¬ëŒì˜ ì–¼êµ´ì´ ì–´ëŠ ìª½ì„ ë³´ê³  ìˆëŠ”ì§€ ê²€ì¶œí•´ ë³´ì
ğŸ—ƒï¸ ì–¼êµ´ ëœë“œë§ˆí¬ ê²€ì¶œ: ëˆˆ, ì½”, ì…, ìœ¤ê³½ì˜ 68ê°œ íŠ¹ì§•ì ìœ¼ë¡œ í‘œí˜„í•œ ì–¼êµ´ ëœë“œë§ˆí¬ë¥¼ ê²€ì¶œí•˜ì—¬ ì‚¬ëŒì˜ ì–¼êµ´ì´ ì–´ëŠ ìª½ì„ ë°”ë¼ë³´ê³  ìˆëŠ”ì§€ íŒŒì•….
```python
import dlib
import math

#ì¤€ë¹„
predictor = dlib.shape_predictor("shape_predictor_68_face_landmarks.dat")
detector = dlib.get_frontal_face_detector()

#ê²€ì¶œ
img = cv2.imread("img/img02.jpg")
dets = detector(img, 1)

for k, d in enumerate(dets):
    shape = predictor(img, d)

    #ì–¼êµ´ ì˜ì—­ í‘œì‹œ
    color_f = (0, 0, 225)
    color_l_out = (255, 0, 0)
    color_l_in = (0, 255, 0)
    line_w = 3
    circle_r = 3
    fontType = cv2.FONT_HERSHEY_SIMPLEX
    fontSize = 1

    cv2.rectangle(img, (d.left(), d.top()), (d.right(), d.bottom()), color_f, line_w)
    cv2.putText(img, str(k), (d.left(), d.top()), fontType, fontSize, color_f, line_w)

    #ì¤‘ì‹¬ì„ ê³„ì‚°í•  ì‚¬ê°í˜• ì¤€ë¹„
    num_of_points_out = 17
    num_of_points_in = shape.num_parts - num_of_points_out
    gx_out = 0
    gy_out = 0
    gx_in = 0
    gy_in = 0
    for shape_point_count in range(shape.num_parts):
        shape_point = shape.part(shape_point_count)
        #print("ì–¼êµ´ ëœë“œë§ˆí¬No.{} ì¢Œí‘œìœ„ì¹˜: ({},{})".format(shape_point_count, shape_point.x, shape_point.y))
        #ì–¼êµ´ ëœë“œë§ˆí¬ë§ˆë‹¤ ê·¸ë¦¬ê¸°
        if shape_point_count<num_of_points_out:
            cv2.circle(img,(shape_point.x, shape_point.y),circle_r,color_l_out, line_w)
            gx_out = gx_out + shape_point.x/num_of_points_out
            gy_out = gy_out + shape_point.y/num_of_points_out
        else:
            cv2.circle(img,(shape_point.x, shape_point.y),circle_r,color_l_in, line_w)
            gx_in = gx_in + shape_point.x/num_of_points_in
            gy_in = gy_in + shape_point.y/num_of_points_in

    #ì¤‘ì‹¬ìœ„ì¹˜ í‘œì‹œ
    cv2.circle(img,(int(gx_out), int(gy_out)),circle_r,(0,0,255), line_w)
    cv2.circle(img,(int(gx_in), int(gy_in)),circle_r,(0,0,0), line_w)

    #ì–¼êµ´ ë°©í–¥ í‘œì‹œ
    theta = math.asin(2*(gx_in-gx_out)/(d.right()-d.left()))
    radian = theta*180/math.pi

    print("ì–¼êµ´ë°©í–¥:{} (ê°ë„:{}ë„)".format(theta,radian))

    #ì–¼êµ´ë°©í–¥ í‘œì‹œ
    if radian<0:
        textPrefix = " left "
    else:
        textPrefix = " right "
    textShow = textPrefix + str(round(abs(radian),1)) + " deg."
    cv2.putText(img, textShow, (d.left(), d.top()), fontType, fontSize, color_f, line_w)

cv2.namedWindow("img",cv2.WINDOW_NORMAL)
cv2.imshow("img",img)
cv2.imwrite("temp.jpg",img)
cv2.waitKey(0)
cv2.destroyAllWindows()
```
![image](https://github.com/user-attachments/assets/fbc06864-aa4d-4a18-be33-c27147666563)

ğŸ” dlibì„ ì´ìš©í•˜ë©´ í‘œì •ì˜ ë³€í™” ê°™ì€ ê²ƒë„ ê²€ì¶œ ê°€ëŠ¥. ì´ë²ˆ í…Œí¬ë‹‰ì€ ì–¼êµ´ ëœë“œë§ˆí¬ë¥¼ ê²€ì¶œí•˜ëŠ” íë¦„ì„ ë°°ìš°ëŠ” ê³¼ì •ìœ¼ë¡œ ìƒê°.


## <span style= 'background-color: #f1f8ff'>9-7: ê²€ì¶œí•œ ì •ë³´ë¥¼ ì¢…í•©í•´ì„œ íƒ€ì„ë©ìŠ¤ë¥¼ ë§Œë“¤ì–´ë³´ì
ğŸ—ƒï¸ íƒ€ì„ë©ìŠ¤ ìƒì„±: ê°„ë‹¨í•œ ê²½í–¥ì„ íŒŒì•…í•˜ëŠ” ë°ëŠ” íƒ€ì„ë©ìŠ¤ê°€ ì ë‹¹í•¨.
```python
movie_name = "timelapse.avi"
fourcc = cv2.VideoWriter_fourcc('X', 'V', 'I', 'D')
video = cv2.VideoWriter(movie_name,fourcc, 30, (Width,Height))
video.write(frame)

video.release()
```


## <span style= 'background-color: #f1f8ff'>9-8: ì „ì²´ ëª¨ìŠµì„ ê·¸ë˜í”„ë¡œ ê°€ì‹œí™”í•´ ë³´ì
ğŸ—ƒï¸ ì „ì²´ ëª¨ìŠµ ê°€ì‹œí™”
```python
import pandas as pd
list_df = pd.DataFrame( columns=['time','people'] )

tmp_se = pd.Series( [num/fps,len(human) ], index=list_df.columns )
list_df = list_df.append( tmp_se, ignore_index=True )

import matplotlib.pyplot as plt
plt.plot(list_df["time"], list_df["people"], label="test")
plt.show()
```
![image](https://github.com/user-attachments/assets/e47ac166-74d2-4db2-8047-0f659985b2f3)


## <span style= 'background-color: #f1f8ff'>9-9: ê±°ë¦¬ì˜ ë³€í™”ë¥¼ ê·¸ë˜í”„ë¡œ í™•ì¸í•´ ë³´ì
ğŸ” ì§€ê¸ˆê¹Œì§€ì˜ ë°©ë²•ì„ í† ëŒ€ë¡œ ë‹¤ë¥¸ ì‹œê°„ëŒ€ì— ì´¬ì˜í•œ ì˜ìƒì„ ë¶„ì„í•˜ê³ , ì‚¬ëŒ ìˆ˜ì˜ ë³€í™”ë¥¼ ì¶”ì¸¡í•  ìˆ˜ ìˆìŒ. ë‹¤ë§Œ HOGë¡œ ë¶„ì„í•œ ë°ì´í„°ëŠ” ë…¸ì´ì¦ˆê°€ ë§ê³  ì˜¤ê²€ì¶œë¡œ ë³€ë™ì´ ë§ì€ ê·¸ë˜í”„ê°€ ë˜ì–´ ê·¸ ì°¨ì´ë¥¼ íŒŒì•…í•˜ê¸° ì–´ë ¤ì›€.


## <span style= 'background-color: #f1f8ff'>9-10: ì´ë™ í‰ê· ì„ ê³„ì‹¼í•´ì„œ ë…¸ì´ì¦ˆë¥¼ ì œê±°í•˜ì
ğŸ—ƒï¸ ì´ë™ í‰ê·  ê³„ì‚°: ë…¸ì´ì¦ˆëŠ” ê³„ì‚°í•˜ì§€ ì•Šì•„ë„ ë  ê²ƒì„ ê³„ì‚°í•´ì„œ ìƒê¸°ëŠ” ì˜¤ì°¨ì„. ë”°ë¼ì„œ ì´ë™ í‰ê· ì„ ê³„ì‚°í•˜ë©´ ì˜¤ì°¨ë¥¼ ì¤„ì¼ ìˆ˜ ìˆìŒ.
```python
import numpy as np
def moving_average(x, y):
    y_conv = np.convolve(y, np.ones(5)/float(5), mode='valid')
    x_dat = np.linspace(np.min(x), np.max(x), np.size(y_conv))
    return x_dat, y_conv
```


### ì¶œì²˜ : íŒŒì´ì¬ ë°ì´í„°ë¶„ì„ ì‹¤ë¬´ í…Œí¬ë‹‰ 100