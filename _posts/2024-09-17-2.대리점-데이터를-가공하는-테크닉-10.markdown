---
layout: post
title: "íŒŒì´ì¬ ë°ì´í„°ë¶„ì„ ì‹¤ë¬´ í…Œí¬ë‹‰ 100 : 2. ëŒ€ë¦¬ì  ë°ì´í„°ë¥¼ ê°€ê³µí•˜ëŠ” í…Œí¬ë‹‰ 10"
date: 2024-09-17 03:01:45 +0900
categories: íŒŒì´ì¬_ë°ì´í„°ë¶„ì„_ì‹¤ë¬´_í…Œí¬ë‹‰_100
---
## <span style= 'background-color: #f1f8ff'>2-0: ì „ì œì¡°ê±´
ğŸ’¡ ì´ ëŒ€ë¦¬ì ì—ì„œëŠ” ìƒí’ˆA~Zê¹Œì§€ 26ê°œì˜ ìƒí’ˆì„ ì·¨ê¸‰í•˜ë©°, ë§¤ì¶œ ì´ë ¥ê³¼ ê³ ê°ì •ë³´ ë°ì´í„°ëŠ” ë‹´ë‹¹ì‚¬ì›ì´ ì‹œìŠ¤í…œì— ì§ì ‘ ì…ë ¥í•©ë‹ˆë‹¤. ì§‘ê³„ ê¸°ê°„ì— ìƒí’ˆ ë‹¨ê°€ì˜ ë³€ë™ì€ ì—†ì—ˆê³  ë§¤ì¶œ ì´ë ¥ì€ ì‹œìŠ¤í…œì—ì„œ CSV íŒŒì¼ë¡œ ì¶œë ¥í–ˆìŠµë‹ˆë‹¤. ê³ ê° ì •ë³´ëŠ” ëŒ€ë¦¬ì  ê´€ë¦¬ìê°€ ì£¼ë³„ë¡œ ì§‘ê³„í•´ì„œ ì—‘ì…€ë¡œ
ê´€ë¦¬í•©ë‹ˆë‹¤.

## <span style= 'background-color: #f1f8ff'>2-1: ë°ì´í„°ë¥¼ ì½ì–´ ë“¤ì´ì
ğŸ—ƒï¸ ë°ì´í„° ë¦¬ë”©
```python
import pandas as pd
uriage_data = pd.read_csv("uriage.csv")
uriage_data.head()
```
â¡ï¸
![image](https://github.com/user-attachments/assets/19b2c6c5-2cb6-4f0e-8838-8cb67f391e41)

```python
kokyaku_data = pd.read_excel("kokyaku_daicho.xlsx")
kokyaku_data.head()
```
â¡ï¸
![image](https://github.com/user-attachments/assets/af71308b-618c-4591-add0-7ca66829964a)

ğŸ” item_nameì´ë‚˜ item_priceì— ê²°ì¸¡ì¹˜ë‚˜ ì˜¤ë¥˜ê°€ ë³´ì´ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŒ. => "ë°ì´í„°ì˜ ì •í•©ì„±ì— ë¬¸ì œê°€ ìˆë‹¤."

âŠ• ë°ì´í„° ì˜¤ë¥˜ì˜ ì˜ˆì‹œ
![image](https://github.com/user-attachments/assets/89789e9b-daaf-4421-ba7e-ec84f2b990e9)

## <span style= 'background-color: #f1f8ff'>2-2: ë°ì´í„°ì˜ ì˜¤ë¥˜ë¥¼ ì‚´í´ë³´ì
ğŸ—ƒï¸ ë°ì´í„° ì˜¤ë¥˜ í™•ì¸
```python
uriage_data["item_name"].head()
```
â¡ï¸
![image](https://github.com/user-attachments/assets/42c07900-ffcd-4454-b333-49ad274f65e6)

## <span style= 'background-color: #f1f8ff'>2-3: ë°ì´í„°ì— ì˜¤ë¥˜ê°€ ìˆëŠ” ìƒíƒœë¡œ ì§‘ê³„í•´ ë³´ì
ğŸ—ƒï¸ ì˜¤ë¥˜ê°€ ìˆëŠ” ìƒíƒœì˜ ë°ì´í„° ì§‘ê³„
```python
uriage_data["purchase_date"] = pd.to_datetime(uriage_data["purchase_date"])
uriage_date["purchase_month"] = uriage_data["purchase_date"].dt.strftime("%Y%m")
res = uriage_data.pivot_table(index="purchase_month", columns="item_name", aggfunc="size", fill_value=0)
res
```
â¡ï¸
![image](https://github.com/user-attachments/assets/859f9c1a-4d2e-43c1-9cd4-41d9d1f2a63e)

ğŸ” 'ìƒí’ˆS', 'ìƒí’ˆs'ì™€ ê°™ì´ ì›ë˜ ë™ì¼í•œ ìƒí’ˆì´ ë‹¤ë¥¸ ìƒí’ˆìœ¼ë¡œ ì§‘ê³„ë˜ëŠ” ë“± ì˜¤ë¥˜ ë°œìƒ. ì´ëŸ° ì˜¤ë¥˜ë¡œ ì¸í•´ ì›ë˜ 26ê°œì˜ ìƒí’ˆì´ 99ê°œì˜ ìƒí’ˆìœ¼ë¡œ ëŠ˜ì–´ë‚¨.

## <span style= 'background-color: #f1f8ff'>2-4: ìƒí’ˆëª… ì˜¤ë¥˜ë¥¼ ìˆ˜ì •í•˜ì
ğŸ—ƒï¸ ë°ì´í„° í˜„í™© íŒŒì•…
```python
print(len(pd.unique(uriage_data.item_name)))
```
â¡ï¸
99

ğŸ—ƒï¸ ë°ì´í„° ì˜¤ë¥˜ ìˆ˜ì •
```python
uriage_data["item_name"] = uriage_data["item_name"].str.upper() #ì†Œë¬¸ìë¥¼ ëŒ€ë¬¸ìë¡œ ë³€í™˜
uriage_data["item_name"] = uriage_data["item_name"].str.replace("  ", "") #ê³µë°± ì œê±° 1
uriage_data["item_name"] = uriage_data["item_name"].str.replace(" ", "") #ê³µë°± ì œê±° 2
uriage_data.sort_values(by=["item_name"], ascending=True)
```
â¡ï¸
![image](https://github.com/user-attachments/assets/21bb10e6-dce8-4d97-94bd-4e21a70994cf)

ğŸ—ƒï¸ ê²°ê³¼ ê²€ì¦
```python
print(len(pd.unique(uriage_data["item_name"])))
print(pd.unique(uriage_data["item_name"]))
```
â¡ï¸
26
['ìƒí’ˆA', 'ìƒí’ˆS', ~~~~~~~~~~~~~, 'ìƒí’ˆJ']

## <span style= 'background-color: #f1f8ff'>2-5: ê¸ˆì•¡ì˜ ê²°ì¸¡ì¹˜ë¥¼ ìˆ˜ì •í•˜ì
ğŸ—ƒï¸ ê²°ì¸¡ì¹˜ ìœ ë¬´ í™•ì¸
```python
uriage_data.isnull().any(axis=0)
#True ê°’ì´ ë‚˜ì˜¤ë©´ ê²°ì¸¡ì¹˜ê°€ ìˆìŒì„ ì˜ë¯¸.
```
â¡ï¸
![image](https://github.com/user-attachments/assets/a6f2665e-fcac-475b-9c5d-7f2f4c197080)

ğŸ—ƒï¸ ê²°ì¸¡ì¹˜ ìˆ˜ì •
```python
flg_is_null = uriage_data["item_price"].isnull()
for trg in list(uriage_data.loc[flg_is_null, "item_name"].unique()):
#listë¥¼ ì´ìš©í•˜ì—¬ ë³€ìˆ˜ì˜ ê°’ì„ ë¦¬ìŠ¤íŠ¸ í˜•ì‹ìœ¼ë¡œ ë³€í™˜.
#locì„ ì´ìš©í•˜ì—¬ ì¡°ê±´ì„ ì§€ì •í•˜ê³  ì¡°ê±´ì— ì¼ì¹˜í•˜ëŠ” ë°ì´í„° ì¤‘ì—ì„œ ì–´ë–¤ ì»¬ëŸ¼ì„ ê°€ì ¸ì˜¬ì§€ ì§€ì •.
#uniqueë¥¼ ì´ìš©í•´ ì¤‘ë³µ ì œê±°.
    price = uriage_data.loc[(~flg_is_null) & (uriage_data["item_name"]==trg), "item_price"].max()
    #locì„ ì´ìš©í•˜ì—¬ ì¡°ê±´ì„ ì§€ì •í•˜ê³  ì¡°ê±´ì— ì¼ì¹˜í•˜ëŠ” ë°ì´í„° ì¤‘ì—ì„œ ì–´ë–¤ ì»¬ëŸ¼ì„ ê°€ì ¸ì˜¬ì§€ ì§€ì •.
    #ë¶€ì • ì—°ì‚°ì ~ì„ í™œìš©.
    uriage_data["item_price"].loc[(flg_is_null) & (uriage_data["item_name"]==trg)] = price
    #ê°€ì ¸ì˜¨ ê¸ˆì•¡ìœ¼ë¡œ ë°ì´í„°ë¥¼ ìˆ˜ì •
uriage_data.head()
```
â¡ï¸
![image](https://github.com/user-attachments/assets/7bf0f228-38b9-435d-b26d-882fc02d1df7)

ğŸ—ƒï¸ ê²°ê³¼ ê²€ì¦
```python
uriage_data.isnull().any(axis=0)
```
â¡ï¸
![image](https://github.com/user-attachments/assets/6463de75-d8e6-41d5-a1ee-73208d77d1a6)

## <span style= 'background-color: #f1f8ff'>2-6: ê³ ê° ì´ë¦„ì˜ ì˜¤ë¥˜ë¥¼ ìˆ˜ì •í•˜ì
ğŸ—ƒï¸ ê³ ê° ì´ë¦„ ì˜¤ë¥˜ ìˆ˜ì •
```python
kokyaku_data["ê³ ê°ì´ë¦„"] = kokyaku_data["ê³ ê°ì´ë¦„"].str.replace("  ", "")
kokyaku_data["ê³ ê°ì´ë¦„"] = kokyaku_data["ê³ ê°ì´ë¦„"].str.replace(" ", "")
kokyaku_data["ê³ ê°ì´ë¦„"].head()
```
â¡ï¸
![image](https://github.com/user-attachments/assets/6aac28cc-c0b8-4bda-8ef2-82608495a68e)

ğŸ” ì´ë¦„ ì…ë ¥ ì˜¤ë¥˜ëŠ” ë” ë³µì¡í•œ ê²½ìš°ê°€ ìˆì„ ìˆ˜ ìˆìŒ. ì´ëŸ° ë•Œì—ëŠ” ë‹´ë‹¹ìì—ê²Œ ë¬¼ì–´ì„œ ì‘ì—…í•´ì•¼ í•˜ëŠ” ê²½ìš°ë„ ìˆìŒ. ë˜, ê°™ì€ ì´ë¦„ì˜ ë°ì´í„°ê°€ ì¡´ì¬í•˜ëŠ” ê²½ìš°ì—ëŠ” ë“±ë¡ì¼, ìƒë…„ì›”ì¼ ë“± ë‹¤ë¥¸ ì •ë³´ë¥¼ ì´ìš©í•´ì„œ êµ¬ë¶„í•´ì•¼ í•¨.

## <span style= 'background-color: #f1f8ff'>2-7: ë‚ ì§œ ì˜¤ë¥˜ë¥¼ ìˆ˜ì •í•˜ì
ğŸ” ì—‘ì…€ ë°ì´í„°ë¥¼ ì·¨ê¸‰í•  ë•Œ ì£¼ì˜í•´ì•¼ í•  ì : ì„œì‹ì´ ë‹¤ë¥¸ ë°ì´í„°ê°€ ì„ì—¬ ìˆì„ ìˆ˜ ìˆìŒ.

ğŸ—ƒï¸ ì˜¤ë¥˜ ë°ì´í„° í™•ì¸
```python
flg_is_serial = kokyaku_data["ë“±ë¡ì¼"].astype("str").str.isdigit()
flg_is_serial.sum()
```
â¡ï¸
22

ğŸ—ƒï¸ ë‚ ì§œ ì˜¤ë¥˜ ìˆ˜ì •
```python
fromSerial = pd.to_timedelta(kokyaku_data.loc[flg_is_serial, "ë“±ë¡ì¼"].astype("float"), unit="D") + pd.to_datetime("1900/01/01")
fromSerial
```
â¡ï¸
![image](https://github.com/user-attachments/assets/f3582555-2821-45ad-9586-ec7ada6dd038)

ğŸ—ƒï¸ ì„œì‹ í†µì¼
```python
fromString = pd.to_datetime(kokyaku_data.loc[~flg_is_serial, "ë“±ë¡ì¼"])
fromString
```
â¡ï¸
![image](https://github.com/user-attachments/assets/3e65f324-2dea-44dc-8ec4-6c472cfa7b7c)

ğŸ—ƒï¸ ë‚ ì§œ ë°ì´í„° ê°±ì‹ 
```python
kokyaku_data["ë“±ë¡ì¼"] = pd.concat([fromSerial, fromString])
```

ğŸ—ƒï¸ ê²°ê³¼ ê²€ì¦
```python
flg_is_serial = kokyaku_data["ë“±ë¡ì¼"].astype("str").str.isdigit()
flg_is_serial.sum()
```
â¡ï¸
0

## <span style= 'background-color: #f1f8ff'>2-8: ê³ ê° ì´ë¦„ì„ í‚¤ë¡œ ë‘ ê°œì˜ ë°ì´í„°ë¥¼ ê²°í•©(ì¡°ì¸)í•˜ì
ğŸ” ì •í•©ì„±ì´ ì—†ëŠ” ë°ì´í„°ëŠ” ë‘ ê°œì˜ ë°ì´í„°ì˜ ì„œë¡œ ë‹¤ë¥¸ ì—´ì„ ì§€ì •í•´ì„œ ê²°í•©í•´ì•¼ í•¨.

ğŸ—ƒï¸ ë°ì´í„° ê²°í•©(ì¡°ì¸)
```python
join_data = pd.merge(uriage_data, kokyaku_data, left_on="customer_name", right_on="ê³ ê°ì´ë¦„", how="left")
join_data = join_data.drop("customer_name", axis=1)
join_data
```
â¡ï¸
![image](https://github.com/user-attachments/assets/41df7927-efb6-4600-a56e-16e31af1c0d3)

## <span style= 'background-color: #f1f8ff'>2-9: ì •ì œí•œ ë°ì´í„°ë¥¼ ë¤í”„í•˜ì
ğŸ—ƒï¸ ì¹¼ëŸ¼ ë°°ì¹˜ ìˆ˜ì •
```python
dump_data = join_data[["purchase_date", "purchase_month", "item_name", "item_price", "ê³ ê°ì´ë¦„", "ì§€ì—­", "ë“±ë¡ì¼"]]
dump_data
```
â¡ï¸
![image](https://github.com/user-attachments/assets/27236050-4736-4e96-b8f6-18640536b083)

ğŸ—ƒï¸ ë°ì´í„° ë¤í”„
```python
dump_data.to_csv("dump_data.csv", index=False)
```

## <span style= 'background-color: #f1f8ff'>2-10: ë°ì´í„°ë¥¼ ì§‘ê³„í•˜ì
ğŸ—ƒï¸ ë°ì´í„° ì§‘ê³„ ì˜ˆì‹œ
```python
import_data = pd.read_csv("dump_data.csv")

byItem = import_data.pivot_table(index="purchase_month", columns="item_name", aggfunc="size", fill_value=0)
byItem
```
![image](https://github.com/user-attachments/assets/ead3e585-668d-41d3-97ea-773640db2b0e)


### ì¶œì²˜ : íŒŒì´ì¬ ë°ì´í„°ë¶„ì„ ì‹¤ë¬´ í…Œí¬ë‹‰ 100