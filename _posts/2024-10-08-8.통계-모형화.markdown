---
layout: post
title: "통계 101 X 데이터 분석 : 8. 통계 모형화"
date: 2024-10-08 04:01:45 +0900
categories: 통계_101_X_데이터_분석
---
## <span style= 'background-color: #f1f8ff'>8-1. 선형회귀 원리의 확장
🗃️ 선형회귀 원리의 확장\
설명변수의 개수 늘리기나 유형 변경, 반응변수의 유형 변경, 회귀모형의 형태 변경 등 3가지로 나눌 수 있음.

🗃️ 다중회귀\
설명변수가 여러 개인 회귀.
![image](https://github.com/user-attachments/assets/c668e25b-1935-493a-9fca-1493524d54d0)
기울기를 **편회귀계수**라 함. 최소제곱법을 이용해 파라미터를 구하면 데이터가 가장 잘 들어맞는 모형을 얻을 수 있음. 이 과정을 **다중회귀분석**이라 함. 설명변수가 2개일 때 그래프를 그리면 회귀모형은 평면이 되는데 이를 **회귀평면**이라 함.

🗃️ 편회귀계수\
회귀분석에서 구한 편회귀계수는 설명변수의 데이터 퍼짐 정도나 단위에 따라 크게 달라지기 때문에 편회귀계수끼리 비교할 수는 없음. 편회귀계수를 비교하기 위해 **표준화편회귀계수**를 이용. 표준화편회귀계수는 회귀분석을 시행하기 전에 각각의 설명변수를 평균 0, 표준편차 1로 변환한 다음 회귀분석을 시행하여 구한 회귀계수임.
![image](https://github.com/user-attachments/assets/f6e411c5-a8ed-4477-b87b-ccc1d1d4ecaf)

🗃️ 범주형 변수를 설명변수로\
범주형 변수를 설명변수로 이용하기 위해서는 0 또는 1과 같은 가변수를 설명변수로 이용하는 등의 요령이 필요.
![image](https://github.com/user-attachments/assets/62a2662c-4f86-49b8-bf94-8aa6cf9661c3)

🗃️ 공분산분석\
일반적인 분산분석에 사용하는 데이터와 함께 양적 변수 데이터가 있는 경우에 후보가 되는 방법. 이 새로 추가한 양적 변수를 **공변량**이라 함. 공분산분석을 이용하면 더 정밀한 분석이 가능해짐. 공분산분석을 사용하기 위해서는 집단 간 회귀의 기울기가 서로 다르지 않아야 하며 회귀계수가 0이 아니어야 한다는 조건을 만족해야 함.

🗃️ 고차원 데이터 문제\
차원이 늘어날수록 파라미터 추정에 필요한 데이터 양이 폭발적으로 증가하는 **차원의 저주** 문제가 발생.
![image](https://github.com/user-attachments/assets/24d754ce-a089-424b-9ae9-cfc1fd8c86c4)

🗃️ 다중공선성\
설명변수가 여러 개인 다중회귀에서 설명변수 사이에 강한 상관이 있는 경우, **다중공선성**이 있다고 말함. 다중공선성이 있다면 회귀계수의 추정오차가 커지는 문제가 발생할 가능성이 있음.
![image](https://github.com/user-attachments/assets/f0afc2cd-9dae-4f9d-aab2-b4794aec2919)

다중공선성 정도를 측정하려면 **분산팽창인수 VIF**를 계산함.
![image](https://github.com/user-attachments/assets/d596cd63-ec6b-4a68-a7a8-ceac8bad6e82)
VIF>10이라면 2개 사이의 상관이 아주 강한 것. 다중공선성이 강하다고 판단했을 때는 서로 상관이 있는 2개 변수 중 하나를 없애거나 차원 축소 방법을 이용하여 설명변수의 개수를 줄이는 것이 좋음.


## <span style= 'background-color: #f1f8ff'>8-2. 회귀모형의 형태 바꾸기
🗃️ 상호작용\
종속변수의 증가 방식이 또 다른 설명변수의 영향을 받을 수도 있는데 이러한 설명변수 간의 상승효과를 **상호작용**이라 함. 상호작용항은 다음과 같은 특성 때문에 많은 통계 사용자가 넣을지 망설이게 됨.
![image](https://github.com/user-attachments/assets/b43d8c48-09da-4652-af03-32fcf70cb79a)

따라서 다음과 같은 때에 적용하는 것이 좋음.
![image](https://github.com/user-attachments/assets/7e79a229-225c-4a94-b0ae-da59c99001dd)

🗃️ 이원배치 분산분석\
여러 개의 요인을 동시에 고려하는 분산분석을 **다원배치 분산분석**이라 하는데, 요인이 2개인 것을 **이원배치 분산분석**이라 함.
![image](https://github.com/user-attachments/assets/34c4eaba-c0ec-4a4e-8730-00555303a8e7)

가설검정 결과 상호작용항이 유의미하지 않다면 상호작용이 없다고 보고 각각의 주효과를 그대로 평가함. 상호작용항이 유의미하다면 상호작용이 있다고 보아 각각의 요인을 나누고 주효과를 하위 검정으로 평가할 수 있음.

🗃️ 비선형회귀\
x에 관해 비선형인 모형을 데이터에 적용할 수는 있으나 계수의 해석이 어려워지기 때문에 무턱대고 복잡한 모형을 택하는 것은 통상 바람직하지 않음. 어느 모형이 적절한가, 애당초 '적절'이라는 말은 어떤 관점에서 본 적절함인가를 생각해야 함.\
파라미터에 관한 비선형회귀모형도 마찬가지로 그 모형을 사용하는 합리적인 이유가 있어야 함.


## <span style= 'background-color: #f1f8ff'>8-3. 일반화선형모형의 개념
🗃️ 선형회귀 원리 확장하기\
일반선형모형 원리를 확장하여 최소제곱법이 아닌 확률분포에 기반한 최대가능도 방법으로 회귀모형을 추정하는 것을 **일반화선형모형**이라 함. 일반화선형모형을 이용하면 더 폭넓은 유형의 반응변수를 대상으로 회귀분석을 실행할 수 있고 더 유연한 모형화가 가능해짐. 이처럼 데이터 성질을 고려하면서 확률 모형을 가정하고, 파라미터를 추정하여 모형을 평가하는 일련의 작업을 **통계 모형화**라 부름.

🗃️ 선형회귀가 적절하지 않은 상황\
반응변수가 '예/아니요'와 같이 값이 2개인 변수이거나, 물건이나 생물의 수처럼 음이 아닌 정수인 상황엔 선형회귀가 적절하지 않음.
![image](https://github.com/user-attachments/assets/6932c93b-c2d0-4fcd-9b52-e16325dc3854)

🗃️ 가능도와 최대가능도 방법\
앞서 설명한 구성의 데이터는 '확률적으로 얼마나 나타나기 쉬운가'에 기반해 데이터에 잘 들어맞는지 평가하는 편이 좋음. 아래 식에서 P를 x에 대한 파라미터 세타의 함수로 본 것을 **가능도**라 함.
![image](https://github.com/user-attachments/assets/afdaaef2-8e17-4c6c-bc30-8f16be50e79b)

가능도가 크다는 것은 그 세타에서 얻은 데이터가 나타나기 쉽다는 것을 뜻함. 그렇게 가능도를 최대화하는 세트를 찾아서 이를 추정값으로 삼으면 얻은 데이터에 가장 잘 들어맞는 파라미터 세타를 정할 수 있음. 이 방법을 **최대가능도 방법**이라 함.
![image](https://github.com/user-attachments/assets/6e572c00-ef96-4dd8-a55c-5bfe3767df1b)

🗃️ 로지스틱 회귀\
일반화선형모형의 일종으로 반응변수가 값이 2개인 범주형 변수일 때 사용하는 회귀. 범주 하나가 일어날 확률을 p로 두고, 설명변수 x가 바뀌었을 때 p가 얼마나 달라지는지를 조사하는 방식.\
이때 p는 이산형 확률분포인 **이항분포**의 파라미터에 속하는데 일어남/일어나지 않음 2가지 상태를 취하는 현상을 가정하고 일어날 확률을 p, 일어나지 않을 확률을 1-p로 둠.
![image](https://github.com/user-attachments/assets/5c75b19d-9a54-4177-927d-47f17315608a)

로지스틱 회귀의 결과를 **오즈비**라는 값으로 평가할 때가 있는데, 오즈비는 로지스틱 회귀뿐 아니라 통계학 전반에서 일어나기 쉬움을 비교하는 척도로서 이용됨. 이때 오즈는 어떤 사건이 일어날 확률과 일어나지 않을 확률의 비율을 나타냄. 2개의 확률 p, q에 대한 2개 오즈 비율을 오즈비라 함. **단,** 오즈비가 2라 해서 일어나기가 2배 쉽다는 것은 아니기 때문에 해석하기 까다로움.

🗃️ 푸아송 회귀\
데이터가 음수가 되지 않는 정수일 때, 특히 반응변수가 개수인 경우 고려해볼 수 있는 일반화선형모형.

🗃️ 일반화선형모형의 사용 구분
![image](https://github.com/user-attachments/assets/9f2f60a6-7663-4217-a47e-80dcaff6d70a)


## <span style= 'background-color: #f1f8ff'>8-4. 통계 모형의 평가와 비교
🗃️ 왈드 검정\
최대가능도 방법으로 얻은 추정값/표준오차를 **왈드 통계량**이라 함. 왈드 통계량을 이용하여 신뢰구간이나 p값을 얻는 검정 방법을 **왈드 검정**이라 함.

🗃️ 가능도비 검정\
최대가능도 방법으로 얻은 통계 모형을 비교하는 방법으로, 모형이 데이터에 잘 맞도록 개선되었는지 확인하는 검정 방법을 **가능도비 검정**이라 함. 가능도비 검정을 시도하기 위해서는 비교할 2개의 모형 중 어느 한쪽이 다른 한쪽을 포함하는 관계여야 함.

🗃️ AIC\
새롭게 얻을 데이터를 얼마나 잘 예측할 수 있는지를 바탕으로 모형의 좋음을 결정하는 지표.
![image](https://github.com/user-attachments/assets/4f49d226-7009-4477-a285-3345b1b95709)

🗃️ BIC\
AIC와 함께 자주 사용하는 정보 기준으로 표본크기에 따라 달라진다는 점이 AIC와 다름.
![image](https://github.com/user-attachments/assets/013f1d70-6053-4de6-9f02-60a024619b1c)


### 출처 : 통계 101 X 데이터 분석