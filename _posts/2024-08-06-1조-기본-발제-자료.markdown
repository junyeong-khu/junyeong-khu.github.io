---
layout: post
title: "1ì¡° ê¸°ë³¸ ë°œì œ ìë£Œ"
date: 2024-08-06 03:01:45 +0900
categories: ë°œì œ-ìë£Œ
---
## <span style= 'background-color: #f1f8ff'>3-1: k-ìµœê·¼ì ‘ ì´ì›ƒ íšŒê·€
â˜† **íšŒê·€**: ì§€ë„ í•™ìŠµ ì•Œê³ ë¦¬ì¦˜ì˜ í•œ ì¢…ë¥˜ë¡œ ì„ì˜ì˜ ì–´ë–¤ ìˆ«ìë¥¼ ì˜ˆì¸¡í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜. ì •í•´ì§„ í´ë˜ìŠ¤ê°€ ì—†ìœ¼ë©° ì„ì˜ì˜ ìˆ˜ì¹˜ë¥¼ ì¶œë ¥í•¨.

â˜† **k-ìµœê·¼ì ‘ ì´ì›ƒ íšŒê·€**: ì˜ˆì¸¡í•˜ë ¤ëŠ” ìƒ˜í”Œì— ê°€ì¥ ê°€ê¹Œìš´ ìƒ˜í”Œ kê°œë¥¼ ì„ íƒí•œ í›„ í•´ë‹¹ ìƒ˜í”Œë“¤ì˜ í‰ê· ì„ ì •ë‹µìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒ. ì´ë•Œ ì´ì›ƒí•œ ìƒ˜í”Œì˜ íƒ€ê¹ƒì€ ì–´ë–¤ í´ë˜ìŠ¤ê°€ ì•„ë‹ˆë¼ ì„ì˜ì˜ ìˆ˜ì¹˜ì„.

â˜† **k-ìµœê·¼ì ‘ ì´ì›ƒ íšŒê·€ë¥¼ í™œìš©í•œ ìƒì„  ë¬´ê²Œ ì—ì¸¡ í”„ë¡œê·¸ë¨**

â€ ë°ì´í„° ì¤€ë¹„: ë°ì´í„° ë¦¬ìŠ¤íŠ¸ ì¤€ë¹„, ì‚°ì ë„ í‘œì‹œ, í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ ì¤€ë¹„ë¥¼ í†µí•´ í”„ë¡œê·¸ë¨ì— ì‚¬ìš©ë  ì „ë°˜ì ì¸ ë°ì´í„° ì¤€ë¹„.
```python
import numpy as np
perch_length = np.array(
    [8.4, 13.7, 15.0, ~~~~~~, 44.0]
    )
perch_weight = np.array(
    [5.9, 32.0, 40.0, ~~~~~~, 1000.0]
    )

import matplotlib.pyplot as plt
plt.scatter(perch_length, perch_weight)
plt.xlabel('length')
plt.ylabel('weight')
plt.show()

from sklearn.model_selection import train_test_split
train_input, test_input, train_target, test_target = train_test_split(perch_length, perch_weight, random_state=42)

train_input = train_input.reshape(-1,1)
test_input = test_input.reshape(-1,1)
```
ğŸš¨ ì£¼ì˜: ì‚¬ì´í‚·ëŸ°ì— ì‚¬ìš©í•  í›ˆë ¨ ì„¸íŠ¸ëŠ” 2ì°¨ì› ë°°ì—´ì´ì–´ì•¼ í•¨. ë”°ë¼ì„œ reshape()ë¥¼ í†µí•´ í¬ê¸° ë³€ê²½.

â ë¨¸ì‹ ëŸ¬ë‹ í”„ë¡œê·¸ë¨ í›ˆë ¨: í›ˆë ¨ ì„¸íŠ¸ë¡œ í›ˆë ¨ í›„ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¡œ ê²°ì •ê³„ìˆ˜ë¥¼ í‰ê°€.
```python
from sklearn.neighbors import KNeighborsRegressor
knr = KNeighborsRegressor()
knr.fit(train_input, train_target)
print(knr.score(test_input, test_target))
```
â¡ï¸ 0.9928094061010639

ğŸ“Œ ê²°ì •ê³„ìˆ˜(R^2): íšŒê·€ë¥¼ í‰ê°€í•˜ëŠ” ì ìˆ˜. 1 - (íƒ€ê¹ƒ - ì˜ˆì¸¡)^2/(íƒ€ê¹ƒ - í‰ê· )^2ì˜ ì‹ìœ¼ë¡œ êµ¬í•¨.

âŠ• ê²°ì •ê³„ìˆ˜ì˜ ì •ë„ íŒŒì•…ì„ ìœ„í•œ ì ˆëŒ“ê°’ ì˜¤ì°¨ ê³„ì‚°
```python
from sklearn.metrics import mean_absolute_error
test_prediction = knr.predict(test_input)
mae = mean_absolute_error(test_target, test_prediction)
print(mae)
```
â¡ï¸ 19.157142857142862

â‚ ê³¼ëŒ€ì í•©â€¢ê³¼ì†Œì í•© í•´ê²°: í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ê²°ì •ê³„ìˆ˜ ì ìˆ˜ë¥¼ ë¹„êµí–ˆì„ ë•Œ í›ˆë ¨ ì„¸íŠ¸ê°€ ë„ˆë¬´ ë†’ì€ **ê³¼ëŒ€ì í•©**, ê·¸ ë°˜ëŒ€ì´ê±°ë‚˜ ë‘ ì ìˆ˜ê°€ ëª¨ë‘ ë‚®ì€ **ê³¼ì†Œì í•©**ì„ í•´ê²°.
- ê³¼ëŒ€ì í•©ì˜ í•´ê²°: ëª¨ë¸ì„ ëœ ë³µì¡í•˜ê²Œ ë§Œë“¤ì–´ í›ˆë ¨ ì„¸íŠ¸ì— ëŒ€í•œ ì˜ì¡´ë„ë¥¼ ì¤„ì„. k-ìµœê·¼ì ‘ ì´ì›ƒì˜ ê²½ìš° kê°’ì„ ëŠ˜ë ¤ì„œ í•´ê²°.
- ê³¼ì†Œì í•©ì˜ í•´ê²°: ëª¨ë¸ì„ ë” ë³µì¡í•˜ê²Œ ë§Œë“¤ì–´ í›ˆë ¨ ì„¸íŠ¸ì— ë” ì˜ ë§ê²Œ ë§Œë“¦. k-ìµœê·¼ì ‘ ì´ì›ƒì˜ ê²½ìš° kê°’ì„ ì¤„ì—¬ì„œ í•´ê²°.

```python
print(knr.score(train_input, train_target))
```
â¡ï¸ 0.9698823289099255 (ê³¼ì†Œì í•©)

```python
knr.n_neighbors = 3 
knr.fit(train_input, train_target)
print(knr.score(train_input))
```
â¡ï¸ 0.9804899950518966

```python
print(knr.score(test_input, test_target))
```
â¡ï¸ 0.974645996398761

## <span style= 'background-color: #f1f8ff'>3-2: ì„ í˜• íšŒê·€
â˜† **k-ìµœê·¼ì ‘ ì´ì›ƒ íšŒê·€ì˜ í•œê³„**: ê°€ì¥ ê°€ê¹Œìš´ ìƒ˜í”Œì„ ì°¾ì•„ íƒ€ê¹ƒì„ í‰ê· í•˜ê¸°ì— ìƒˆë¡œìš´ ìƒ˜í”Œì´ í›ˆë ¨ ì„¸íŠ¸ì˜ ë²”ìœ„ë¥¼ ë²—ì–´ë‚˜ë©´ ì—‰ëš±í•œ ê°’ì„ ì˜ˆì¸¡í•  ìˆ˜ ìˆìŒ.
![image](https://github.com/user-attachments/assets/a2edd1ec-d1ac-46a9-a87c-6a8bd6f913cb)
â¬†ï¸ k-ìµœê·¼ì ‘ ì´ì›ƒ íšŒê·€ì˜ í•œê³„

â˜† **ì„ í˜• íšŒê·€**: íŠ¹ì„±ê³¼ íƒ€ê¹ƒ ì‚¬ì´ì˜ ê´€ê³„ë¥¼ ê°€ì¥ ì˜ ë‚˜íƒ€ë‚´ëŠ” ì„ í˜• ë°©ì •ì‹ì„ ì°¾ì•„ ê²°ê³¼ë¥¼ ì˜ˆì¸¡í•¨.
![image](https://github.com/user-attachments/assets/fd1b7d16-8387-4fea-852f-934b33dad8cf)
â¬†ï¸ ì„ í˜• íšŒê·€ë¥¼ í•  ê²½ìš° ìœ„ ê·¸ë˜í”„ì˜ 3ê³¼ ê°™ì€ ì§ì„ ì„ ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ì´ ìë™ìœ¼ë¡œ ì°¾ìŒ.

```python
from sklearn.linear_model import LinearRegression
lr = LinearRegression()
lr.fit(train_input, train_target)
print(lr.predict([[50]]))
```
â¡ï¸ [1241.83860323]

```python
print(lr.coef_, lr.intercept_)
```
â¡ï¸ [39.01714496] -709.0186449535477

```python
plt.scatter(train_input, train_target)
plt.plot([15, 50], [15*lr.coef_+lr.intercept_, 50*lr.coef_+lr.intercept_])
plt.scatter(50, 1241.8, marker='^')
plt.show()
```
â¡ï¸
![image](https://github.com/user-attachments/assets/7fe62594-0241-4880-9fd9-dbd68a1bed21)

ğŸ“Œ ì‚¬ì´í‚·ëŸ° ëª¨ë¸ í´ë˜ìŠ¤ì˜ ë©”ì„œë“œëª…: ì‚¬ì´í‚·ëŸ°ì˜ ëª¨ë¸ í´ë˜ìŠ¤ë“¤ì€ í›ˆë ¨, í‰ê°€, ì˜ˆì¸¡í•˜ëŠ” ë©”ì„œë“œ ì´ë¦„ì´ ëª¨ë‘ ë™ì¼.

ğŸ“Œ ëª¨ë¸ íŒŒë¼ë¯¸í„°: ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ì´ ì°¾ì€ ê°’. ì¦‰ ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ì˜ í›ˆë ¨ ê³¼ì •ì€ ìµœì ì˜ ëª¨ë¸ íŒŒë¼ë¯¸í„°ë¥¼ ì°¾ëŠ” ê³¼ì •ê³¼ ê°™ìŒ.

ğŸ“Œ ì‚¬ë¡€ ê¸°ë°˜ í•™ìŠµ: ëª¨ë¸ íŒŒë¼ë¯¸í„° ì—†ì´ í›ˆë ¨ ì„¸íŠ¸ë¥¼ ì €ì¥í•˜ëŠ” ê²ƒì´ í›ˆë ¨ì˜ ì „ë¶€ì¸ í•™ìŠµ. (ex: k-ìµœê·¼ì ‘ ì´ì›ƒ)

```python
print(lr.score(train_input, train_target))
print(lr.score(test_input, test_target))
```
â¡ï¸ 0.9398463339976039   
â¡ï¸ 0.8247503123313558 (ê³¼ì†Œì í•©)

â˜† **ì„ í˜• íšŒê·€ì˜ í•œê³„**: ìƒ˜í”Œë“¤ì´ ì •í™•í•œ ì§ì„  ë¶„í¬ê°€ ì•„ë‹ˆë¼ë©´ ê³¼ì†Œì í•©ì´ ì¼ì–´ë‚  ê°€ëŠ¥ì„±ì´ í¼. ì•„ë˜ ê·¸ë˜í”„ì—ì„œ ë†ì–´ì˜ ë¬´ê²Œê°€ ìŒìˆ˜ ê°’ì„ ê°€ì§ˆ ê²ƒì´ë¼ ì˜ˆìƒí•˜ëŠ” ê²ƒì²˜ëŸ¼ í˜„ì‹¤ì—ì„œ ë¶ˆê°€ëŠ¥í•œ ì˜ˆì¸¡ì´ ì¼ì–´ë‚  ê°€ëŠ¥ì„±ì´ ìˆìŒ.

â˜† **ë‹¤í•­ íšŒê·€**: ë‹¤í•­ì‹ì„ ì‚¬ìš©í•œ ì„ í˜• íšŒê·€.
```python
train_poly = np.column_stack((train_input ** 2, train_input))
test_poly = np.column_stack((test_input ** 2, test_input))

lr = LinearRegression()
lr.fit(train_poly, train_target)

print(lr.coef_, lr.intercept_) 
```
â¡ï¸ [ 1.01433211 -21.55792498] 116.0502107827827

```python
point = np.arrange(15, 50)
plt.scatter(train_input, train_target)
plt.plot(point, 1.01*point**2 - 21.6*point + 116.05)
plt.scatter([50], [1574], marker='^')
plt.show()
```
â¡ï¸
![image](https://github.com/user-attachments/assets/e065574d-db5e-4afe-a2cf-31efe7a404e8)

```python
print(lr.score(train_poly, train_target))
print(lr.score(test_poly, test_target))
```
â¡ï¸ 0.9706807451768623
â¡ï¸ 0.9775935108325122 (ê³¼ì†Œì í•©)

â˜† **ë‹¤í•­ íšŒê·€ì˜ í•œê³„**: í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì— ëŒ€í•œ ì ìˆ˜ê°€ ì„ í˜• íšŒê·€ë³´ë‹¤ëŠ” í¬ê²Œ ë†’ì•„ì¡Œì§€ë§Œ ì—¬ì „íˆ ê³¼ì†Œì í•©ì´ ë‚¨ì•„ìˆìŒ.

## <span style= 'background-color: #f1f8ff'>3-3: íŠ¹ì„± ê³µí•™ê³¼ ê·œì œ
â˜† **ë‹¤ì¤‘ íšŒê·€**: ì—¬ëŸ¬ ê°œì˜ íŠ¹ì„±ì„ ì‚¬ìš©í•œ ì„ í˜• íšŒê·€. íŠ¹ì„±ì´ 2ê°œì¼ ê²½ìš° ì„ í˜• íšŒê·€ëŠ” í‰ë©´ì„ í•™ìŠµí•¨. íŠ¹ì„±ì´ ë§ì€ ê³ ì°¨ì›ìœ¼ë¡œ ê°ˆ ìˆ˜ë¡ ì„ í˜• íšŒê·€ëŠ” ë§¤ìš° ë³µì¡í•œ ëª¨ë¸ì„ í‘œí˜„í•  ìˆ˜ ìˆìŒ.
![image](https://github.com/user-attachments/assets/8c23db29-2bca-45c7-8b6e-d47b1d69524d)
â¬†ï¸ íŠ¹ì„±ì´ 2ê°œì¼ ë•Œì™€ 3ê°œì¼ ë•Œì˜ ì„ í˜• íšŒê·€ ëª¨í˜•

â˜† **íŠ¹ì„± ê³µí•™**: ê¸°ì¡´ì˜ íŠ¹ì„±ì„ ì‚¬ìš©í•´ ìƒˆë¡œìš´ íŠ¹ì„±ì„ ë½‘ì•„ë‚´ëŠ” ì‘ì—…. ì˜ˆë¥¼ ë“¤ì–´ ì´ì „ ì˜ˆì œì—ì„œì˜ ë†ì–´ ê¸¸ì´ë¥¼ ì œê³±í•  ìˆ˜ ìˆê³ , ë†ì–´ ê¸¸ì´ì™€ ë†ì–´ ë†’ì´ë¥¼ ê³±í•  ìˆ˜ë„ ìˆìŒ.

â˜† **ë‹¤ì¤‘ íšŒê·€ë¥¼ í™œìš©í•œ ìƒì„  ë¬´ê²Œ ì˜ˆì¸¡ í”„ë¡œê·¸ë¨**

â€ ë°ì´í„° ì¤€ë¹„: íŒë‹¤ìŠ¤ë¥¼ í™œìš©í•˜ì—¬ ë” ê°„ë‹¨í•˜ê²Œ ë°ì´í„° ì¤€ë¹„.
```python
import pandas as pd
df = pd.read_csv('htttps://bit.ly/perch_csv')
perch_full = df.to_numpy()
print(perch_full)
```
â¡ï¸

![image](https://github.com/user-attachments/assets/19797d1c-7420-4787-a8e4-1092ecd6f44a)

ğŸ“Œ CSV íŒŒì¼: íŒë‹¤ìŠ¤ ë°ì´í„°í”„ë ˆì„ì„ ë§Œë“¤ê¸° ìœ„í•´ ë§ì´ ì‚¬ìš©í•˜ëŠ” íŒŒì¼ë¡œ ì½¤ë§ˆë¡œ ë‚˜ëˆ„ì–´ì ¸ ìˆëŠ” í…ìŠ¤íŠ¸ íŒŒì¼.

```python
import numpy as np
perch_weight = np.array(
    [5.9, 32.0, 40.0, ~~~~~, 1000.0]
    )
from sklearn.model_selection import train_test_split
train_input, test_input, train_target, test_target = train_test_split(perch_full, perch_weight, random_state=42)
```

â ë³€í™˜ê¸°ë¥¼ í™œìš©í•œ íŠ¹ì„± ì¤€ë¹„: ì‚¬ì´í‚·ëŸ°ì—ì„œ íŠ¹ì„±ì„ ë§Œë“¤ê±°ë‚˜ ì „ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ì œê³µí•˜ëŠ” í´ë˜ìŠ¤ì¸ ë³€í™˜ê¸°ë¥¼ í™œìš©í•˜ì—¬ ë‹¤ì–‘í•œ íŠ¹ì„±ë“¤ì„ ì¤€ë¹„.
```python
from sklearn.preprocessing import PlolynomialFeatures
poly = PolynomialFeatures()
poly = PolynomialFeatures(include_bias=False) 
poly.fit(train_input)
train_poly = poly.transform(train_input)
test_poly = poly.transform(test_input)
print(train_poly.shape)
```
â¡ï¸ (42, 9) (9ê°œì˜ íŠ¹ì„±)

ğŸš¨ ì£¼ì˜: transform ì „ì—ëŠ” ê¼­ fitì„ ì‚¬ìš©í•´ì•¼í•¨. ì‚¬ì´í‚·ëŸ°ì˜ ì¼ê´€ëœ api ë•Œë¬¸ì— ë‘ ë‹¨ê³„ë¡œ ë‚˜ë‰˜ì–´ì ¸ ìˆìŒ.

ğŸ“Œ transformì—ì„œ 1ì„ ì¶œë ¥í•˜ëŠ” ì´ìœ : ì„ í˜• ë°©ì •ì‹ì˜ ì ˆí¸ì€ 1ì— ê³±í•´ì§€ëŠ” ê³„ìˆ˜ë¼ê³  ë³¼ ìˆ˜ ìˆìŒ. ì‚¬ì´í‚·ëŸ°ì˜ ì„ í˜• ëª¨ë¸ì€ ìë™ìœ¼ë¡œ ì ˆí¸ì„ ì¶”ê°€í•˜ê¸°ì— 1ì„ ì—†ì• ë„ ë¨.

âŠ• 9ê°œì˜ íŠ¹ì„±ì˜ ì…ë ¥ ì¡°í•© í™•ì¸
```python
poly.get_feature_names()
```
â¡ï¸ ['x0', x'1,' 'x2', "x0^2' ',X"O x1', X"O x2", "x1^2", "x1 x2', "x2^2"]

â‚ ë‹¤ì¤‘ íšŒê·€ ëª¨ë¸ í›ˆë ¨: ì—¬ëŸ¬ ê°œì˜ íŠ¹ì„±ì„ ì‚¬ìš©í•˜ì—¬ ì„ í˜• íšŒê·€ë¥¼ ìˆ˜í–‰í•˜ëŠ” ê²ƒê³¼ ê°™ìŒ.
```python
from sklearn.linear_model import LinearRegression
lr = LinearRegression
lr.fit(train_poly, train_target)
print(lr.score(train_poly, train_target))
print(lr.score(test_poly, test_target))
```
â¡ï¸ 0.9903183436982124   
â¡ï¸ 0.9714559911594134 (ê³¼ì†Œì í•© í•´ê²°)

ğŸš¨ ì£¼ì˜: PolynomialFeatures í´ë˜ìŠ¤ì˜ degree ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ í•„ìš”í•œ ê³ ì°¨í•­ì˜ ìµœëŒ€ ì°¨ìˆ˜ë¥¼ ì§€ì •í•  ìˆ˜ ìˆìŒ. **ë‹¤ë§Œ** ë„ˆë¬´ ê³ ì°¨ì›ì´ ë  ê²½ìš° í›ˆë ¨ ì„¸íŠ¸ì— ë„ˆë¬´ ê³¼ëŒ€ì í•©ë˜ë¯€ë¡œ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì—ì„œëŠ” í˜•í¸ì—†ëŠ” ì ìˆ˜ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŒ.

â˜† **ê·œì œ**: ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì´ í›ˆë ¨ ì„¸íŠ¸ë¥¼ ë„ˆë¬´ ê³¼ë„í•˜ê²Œ í•™ìŠµí•˜ì§€ ëª»í•˜ë„ë¡ í•˜ëŠ” ê²ƒ. ì„ í˜• íšŒê·€ ëª¨ë¸ì˜ ê²½ìš° íŠ¹ì„±ì— ê³±í•´ì§€ëŠ” ê³„ìˆ˜ì˜ í¬ê¸°ë¥¼ ì‘ê²Œ ë§Œë“¤ì–´ í–‰í•  ìˆ˜ ìˆìŒ.
![image](https://github.com/user-attachments/assets/2da1ed9a-2bbe-47ee-b294-d78cad23fe88)
â¬†ï¸ ì„ í˜• íšŒê·€ ê·œì œì˜ ì›ë¦¬

ğŸ“Œ ê·œì œì˜ ì¥ì : ë§ì€ íŠ¹ì„±ì„ ì‚¬ìš©í–ˆìŒì—ë„ ë¶ˆêµ¬í•˜ê³  í›ˆë ¨ ì„¸íŠ¸ì— ë„ˆë¬´ ê³¼ëŒ€ì í•©ë˜ì§€ ì•Šì•„ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì—ì„œë„ ì¢‹ì€ ì„±ëŠ¥ì„ ë‚¼ ìˆ˜ ìˆìŒ.

ğŸš¨ ì£¼ì˜: íŠ¹ì„±ì˜ ìŠ¤ì¼€ì¼ì´ ì •ê·œí™”ë˜ì§€ ì•Šìœ¼ë©´ ê³„ìˆ˜ ê°’ì— ì°¨ì´ê°€ ë‚˜ê²Œ ë˜ê¸°ì— ê·œì œë¥¼ ì ìš©í•˜ê¸° ì „ì— ë¨¼ì € ì •ê·œí™”ë¥¼ í•´ì•¼í•¨.

âŠ•StandardScalerë¥¼ í™œìš©í•œ ì •ê·œí™”
```python
from sklearn.preprocessing import StandardScaler
ss = StandardScaler()
ss.fit(train_poly) 
train_scaled = ss.transform(train_poly)
test_scaled = ss.transform(test_poly)
```

â˜† **ë¦¿ì§€ íšŒê·€**: ê³„ìˆ˜ë¥¼ ì œê³±í•œ ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ê·œì œë¥¼ ì ìš©í•œ ì„ í˜• íšŒê·€ ëª¨ë¸.
```python
from sklearn.linear_model import Ridge
ridge = Ridge()
ridge.fit(train_scaled, train_target)
print(ridge.score(train_scaled, train_target))
print(ridge.score(test_scaled, test_target))
```
â¡ï¸ 0.9896101671037343   
â¡ï¸ 0.9790693977615398

âŠ• alphaë¥¼ í™œìš©í•œ ê·œì œì˜ ê°•ë„ ì¡°ì ˆ(alphaê°€ ì»¤ì§€ë©° ê·œì œ ê°•ë„ê°€ ì„¸ì§)
```python
import matplotlin.pyplot as plt
train_score = [] #alpha ê°’ì„ ë°”ê¿€ ë•Œë§ˆë‹¤ score() ë©”ì„œë“œì˜ ê²°ê³¼ë¥¼ ì €ì¥í•  ë¦¬ìŠ¤íŠ¸ë¥¼ ìƒì„±í•˜ëŠ” ëª…ë ¹ì–´
test_score = []
alpha_list = [0.001, 0.01, 0.1, 1, 10, 100] #ì‚¬ìš©í•  alphaì˜ ë¦¬ìŠ¤íŠ¸ë¥¼ ì§€ì •í•˜ëŠ” ëª…ë ¹ì–´
for alpha in alpha_list:
    ridge = Ridge(alpha=alpha) #ë¦¿ì§€ ëª¨ë¸ì„ ë§Œë“œëŠ” ëª…ë ¹ì–´
    ridge.fit(train_scaled, train_target)
    train_score.append(ridege.score(train_scaled, train_target)) #í›ˆë ¨ ì ìˆ˜ë¥¼ ì €ì¥
    train_score.append(ridge.score(test_scaled, test_target))

plt.plot(np.log10(alpha_list), train_score)
plt.plot(np.log10(alpha_list), test_score)
plt.show()
```
â¡ï¸
![image](https://github.com/user-attachments/assets/aba768c9-5207-4e3a-a298-6674ea2ae7b3)
â¬†ï¸ alpha ê°’ì— ë”°ë¥¸ í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ì ìˆ˜ë¥¼ ë‚˜íƒ€ë‚¸ ê·¸ë˜í”„. ë‘ ê·¸ë˜í”„ê°€ ê°€ì¥ ê°€ê¹ê³  í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ì ìˆ˜ê°€ ê°€ì¥ ë†’ì€ -1, ì¦‰ 0.1ì´ ê°€ì¥ ì ì ˆí•œ alpha ê°’.

ğŸ“Œ ê·¸ë˜í”„ë¥¼ ë¡œê·¸ ìŠ¤ì¼€ì¼ë¡œ ê·¸ë¦¬ëŠ” ì´ìœ : 0.001ë¶€í„° 10ë°°ì”© ëŠ˜ë ¸ê¸° ë•Œë¬¸ì— ê·¸ëŒ€ë¡œ ê·¸ë˜í”„ë¥¼ ê·¸ë¦¬ë©´ ì™¼ìª½ì´ ë„ˆë¬´ ì´˜ì´˜í•´ì§.

```python
ridge = Ridge(alpha=0.1)
ridge.fit(train_scaled, train_target)
print(ridge.score(train_scaled, train_target))
print(ridge.score(test_scaled, test_target))
```
â¡ï¸ 0.9903815817570366   
â¡ï¸ 0.9827976465386926

â˜† **ë¼ì˜ íšŒê·€**: ê³„ìˆ˜ì˜ ì ˆëŒ“ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ê·œì œë¥¼ ì ìš©í•œ ì„ í˜• íšŒê·€ ëª¨ë¸. ê³„ìˆ˜ë¥¼ 0ìœ¼ë¡œ ë§Œë“¤ ìˆ˜ë„ ìˆìŒ.
```python
from sklearn.linear_model import Lasso
lasso = Lasso()
lasso.fit(train_scaled, train_target)
print(lasso.score(train_scaled, train_target))
print(lasso.score(test_scaled, test_target))
```
â¡ï¸ 0.9897898972080961   
â¡ï¸ 0.9800593698421883

âŠ• alphaë¥¼ í™œìš©í•œ ê·œì œì˜ ê°•ë„ ì¡°ì ˆ(alphaê°€ ì»¤ì§€ë©° ê·œì œ ê°•ë„ê°€ ì„¸ì§)
```python
train_score = [] #alpha ê°’ì„ ë°”ê¿€ ë•Œë§ˆë‹¤ score() ë©”ì„œë“œì˜ ê²°ê³¼ë¥¼ ì €ì¥í•  ë¦¬ìŠ¤íŠ¸ë¥¼ ìƒì„±í•˜ëŠ” ëª…ë ¹ì–´
test_score = []
alpha_list = [0.001, 0.01, 0.1, 1, 10, 100] #ì‚¬ìš©í•  alphaì˜ ë¦¬ìŠ¤íŠ¸ë¥¼ ì§€ì •í•˜ëŠ” ëª…ë ¹ì–´
for alpha in alpha_list:
    lasso = Lasso(alpha=alpha, max_iter=10000) #ë¼ì˜ ëª¨ë¸ì„ ë§Œë“œëŠ” ëª…ë ¹ì–´. max_iterëŠ” ë°˜ë³µ íšŸìˆ˜ë¥¼ ëŠ˜ë¦¬ê¸° ìœ„í•œ ëª…ë ¹ì–´.
    lasso.fit(train_scaled, train_target)
    train_score.append(lasso.score(train_scaled, train_target)) #í›ˆë ¨ ì ìˆ˜ë¥¼ ì €ì¥
    train_score.append(lasso.score(test_scaled, test_target))

plt.plot(np.log10(alpha_list), train_score)
plt.plot(np.log10(alpha_list), test_score)
plt.show()
```
â¡ï¸
![image](https://github.com/user-attachments/assets/4f09adf0-29f5-486c-8b8a-82b43b0fee68)
â¬†ï¸ alpha ê°’ì— ë”°ë¥¸ í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ì ìˆ˜ë¥¼ ë‚˜íƒ€ë‚¸ ê·¸ë˜í”„. ë‘ ê·¸ë˜í”„ê°€ ê°€ì¥ ê°€ê¹ê³  í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ì ìˆ˜ê°€ ê°€ì¥ ë†’ì€ 1, ì¦‰ 10ì´ ê°€ì¥ ì ì ˆí•œ alpha ê°’.

```python
lasso = Lasso(alpha=10)
lasso.fit(train_scaled, train_target)
print(lasso.score(train_scaled, train_target))
print(lasso.score(test_scaled, test_target))
```
â¡ï¸ 0.9888067471131867   
â¡ï¸ 0.9824470598706695

### ì¶œì²˜ : í˜¼ì ê³µë¶€í•˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹+ë”¥ëŸ¬ë‹