---
layout: post
title: "νΌμ κ³µλ¶€ν•λ” λ¨Έμ‹ λ¬λ‹+λ”¥λ¬λ‹ : 2. λ°μ΄ν„° λ‹¤λ£¨κΈ°"
date: 2024-07-29 03:01:45 +0900
categories: KHUDA
---
## <span style= 'background-color: #f1f8ff'>2-1: ν›λ ¨ μ„ΈνΈμ™€ ν…μ¤νΈ μ„ΈνΈ
β† **μ§€λ„ ν•™μµκ³Ό λΉ„μ§€λ„ ν•™μµ**
- **μ§€λ„ ν•™μµ**: μ…λ ¥(λ°μ΄ν„°)κ³Ό νƒ€κΉƒ(μ •λ‹µ)μΌλ΅ μ΄λ¤„μ§„ ν›λ ¨ λ°μ΄ν„°κ°€ ν•„μ”ν• ν•™μµ.
- **λΉ„μ§€λ„ ν•™μµ**: νƒ€κΉƒ μ—†μ΄ μ…λ ¥ λ°μ΄ν„°λ§ μ‚¬μ©ν•λ” ν•™μµ.
- κ°•ν™” ν•™μµ: μ•κ³ λ¦¬μ¦μ΄ ν–‰λ™ν• κ²°κ³Όλ΅ μ–»μ€ λ³΄μƒμ„ μ‚¬μ©ν•λ” ν•™μµ. ν•΄λ‹Ή κµμ¬μ—μ„ λ‹¤λ£¨μ§€ μ•μ.

β† **ν›λ ¨ μ„ΈνΈμ™€ ν…μ¤νΈ μ„ΈνΈ**: λ¨Έμ‹ λ¬λ‹ μ•κ³ λ¦¬μ¦μ μ„±λ¥μ„ μ λ€λ΅ ν‰κ°€ν•κΈ° μ„ν•΄ ν•„μ”ν• μ”μ†λ“¤.
- **ν›λ ¨ μ„ΈνΈ**: λ¨Έμ‹ λ¬λ‹ μ•κ³ λ¦¬μ¦μ ν›λ ¨μ— μ‚¬μ©λλ” λ°μ΄ν„°.
- **ν…μ¤νΈ μ„ΈνΈ**: λ¨Έμ‹ λ¬λ‹ μ•κ³ λ¦¬μ¦μ ν‰κ°€μ— μ‚¬μ©λλ” λ°μ΄ν„°.
- **ν›λ ¨ μ„ΈνΈμ™€ ν…μ¤νΈ μ„ΈνΈλ¥Ό μ¤€λΉ„ν•λ” λ°©λ²•**: λ‹¤λ¥Έ λ°μ΄ν„°λ¥Ό μ¤€λΉ„ν•κ±°λ‚ μ΄λ―Έ μ¤€λΉ„λ λ°μ΄ν„° μ¤‘μ—μ„ μΌλ¶€λ¥Ό λ—΄μ–΄λ‚΄μ–΄ ν™μ©. ν›„μλ¥Ό μ£Όλ΅ ν™μ©.
- **μƒν”λ§ νΈν–¥**: ν›λ ¨ μ„ΈνΈμ™€ ν…μ¤νΈ μ„ΈνΈμ—λ” μƒν”μ΄ κ³¨κ³ λ£¨ μ„μ—¬ μμ–΄μ•Ό μ λ€λ΅ λ μ§€λ„ ν•™μµ λ¨λΈμ„ λ§λ“¤ μ μμ. μ΄λ• μƒν”μ΄ κ³¨κ³ λ£¨ μ„μ—¬ μμ§€ μ•μ€ κ²½μ°λ¥Ό **μƒν”λ§ νΈν–¥**μ΄λΌκ³  ν•¨.

β† **λ„νμ΄λ¥Ό ν™μ©ν• μƒμ„  κµ¬λ¶„ λ¨Έμ‹ λ¬λ‹ ν”„λ΅κ·Έλ¨**
1. 2μ°¨μ› λ„νμ΄ λ°°μ—΄ λ³€ν™: λ„νμ΄ λ°°μ—΄λ΅ λ³€ν™ν•λ©΄ μ‹μ‘μ μ΄ μ™Όμ½ μ„λ΅ λλ©° ν–‰κ³Ό μ—΄μ΄ λ§λ” ν•νƒλ΅ μ¶λ ¥λ¨.
```python
#2μ°¨μ› λ„νμ΄ λ°°μ—΄ λ³€ν™μ—μ„ μ‚¬μ©λλ” λ…λ Ήμ–΄

import numpy as np #ν•¨μ μ‚¬μ©μ„ μ„ν•΄ λ¶λ¬μ¤λ” λ…λ Ήμ–΄
input_arr = np.array(fish_data) #λ„νμ΄ λ°°μ—΄λ΅ fish_dataλ¥Ό λ³€ν™μ‹ν‚¤λ” λ…λ Ήμ–΄
```
2. ν›λ ¨ μ„ΈνΈμ™€ ν…μ¤νΈ μ„ΈνΈμ μƒμ„±: μƒν”λ§ νΈν–¥ λ°©μ§€λ¥Ό μ„ν•΄ λ¬΄μ‘μ„λ΅ μ„ νƒ.
```python
#ν›λ ¨ μ„ΈνΈμ™€ ν…μ¤νΈ μ„ΈνΈμ μƒμ„±μ—μ„ μ‚¬μ©λλ” λ…λ Ήμ–΄

np.random.seed(μ •μ) #λλ¤ μ‹λ“λ¥Ό μ„¤μ •ν•λ” λ…λ Ήμ–΄. μ±…κ³Ό λ™μΌν• κ²°κ³Όλ¥Ό μ¬ν„ν•κΈ° μ„ν•΄ μ‚¬μ©
index = np.arrange(μ •μ) #0μ—μ„ μ •μ-1κΉμ§€ 1μ”© μ¦κ°€ν•λ” μΈλ±μ¤λ¥Ό λ§λ“λ” λ…λ Ήμ–΄
np.random.shuffle(index) #indexμ λ°°μ—΄μ„ λ¬΄μ‘μ„λ΅ μ„λ” λ…λ Ήμ–΄

train_input = input_arr[index[:μ •μ]] #0λ¶€ν„° μ •μ-1κΉμ§€μ input_arrμ— μ €μ¥λ λ°°μ—΄μ„ train_inputμ— μ „λ‹¬ν• μƒλ΅μ΄ μƒν”μ„ λ§λ“λ” λ…λ Ήμ–΄ 

plt.scatter(train_input[:,0], train_input[:,1]) #μ‚°μ λ„λ¥Ό ν‘ν„ν•  λ• :,0μ€ 1μ—΄μ„ xμ¶•μΌλ΅, :,1μ€ 2μ—΄μ„ Yμ¶•μΌλ΅ ν‘ν„ν•λΌλ” μλ―Έ
```
π¨ μ£Όμ: μ…λ ¥κ³Ό νƒ€κΉƒμ΄ ν•¨κ» μ„ νƒλμ–΄μ•Ό ν•κΈ°μ— μΈλ±μ¤λ¥Ό μ„¤μ •ν• κ²ƒ.
π“ μ¬λΌμ΄μ‹±(:): μΈλ±μ¤μ λ²”μ„λ¥Ό μ§€μ •ν•λ” μ—°μ‚°μ. λ§μ§€λ§‰ μΈλ±μ¤μ μ›μ†λ” ν¬ν•¨ν•μ§€ μ•μ.

3. λ¨Έμ‹ λ¬λ‹ ν”„λ΅κ·Έλ¨ ν›λ ¨: ν›λ ¨ μ„ΈνΈλ΅ ν›λ ¨ ν›„ ν…μ¤νΈ μ„ΈνΈλ΅ μ •ν™•λ„λ¥Ό ν…μ¤νΈ.
```python
#λ¨Έμ‹ λ¬λ‹ ν”„λ΅κ·Έλ¨ ν›λ ¨μ—μ„ μ‚¬μ©λλ” λ…λ Ήμ–΄

from sklearn.neighbors import KNeighborsClassifier #ν¨ν‚¤μ§€μ—μ„ νΉμ • ν΄λμ¤λ§ μ„ν¬νΈν•λ” λ…λ Ήμ–΄
kn = KNeighborsClassifier() #ν•΄λ‹Ή ν•¨μμ κ°μ²΄λ¥Ό λ§λ“λ” λ…λ Ήμ–΄ 
kn = kn.fit(train_input, train_target) #μ£Όμ–΄μ§„ λ°μ΄ν„°λ΅ μ•κ³ λ¦¬μ¦μ„ ν›λ ¨ν•λ” λ…λ Ήμ–΄
kn.score(test_input, test_target) #μ£Όμ–΄μ§„ λ°μ΄ν„°λ΅ μ•κ³ λ¦¬μ¦μ μ •ν™•λ„λ¥Ό ν‰κ°€ν•λ” λ…λ Ήμ–΄
```

## <span style= 'background-color: #f1f8ff'>2-2: λ°μ΄ν„° μ „μ²λ¦¬
β† **λ„νμ΄λ΅ λ°μ΄ν„° μ¤€λΉ„ν•κΈ°**
```python
import numpy as np #λ„νμ΄λ¥Ό λ¶λ¬μ¤λ©° npλ΅ ν†µμΉ­ν•¨
fish_data = np.column_stack((fish_length, fish_weight)) #ν–‰κ³Ό μ—΄μ„ λ§μ¶ ν•λ‚μ λ¦¬μ¤νΈλ΅ λ³€ν™ν•λ” λ…λ Ήμ–΄. ν•΄λ‹Ή κ³Όμ •μ„ fish_lengthμ™€ fish_weight λ¦¬μ¤νΈ λ‚΄μ— μλ” μ”μ† μ „λ¶€μ— ν–‰ν•¨. 1-3μ—μ„ μ§„ν–‰ν• λ¦¬μ¤νΈ λ‚΄ν¬ κµ¬λ¬Έκ³Ό μ μ‚¬
fish_target = np.concatenate((np.ones(μ •μ), np.zeros(μ •μ))) #μ •μ κ°μ 1κ³Ό μ •μ κ°μ 0μΌλ΅ κµ¬μ„±λ λ¦¬μ¤νΈλ¥Ό ν•λ‚μ λ¦¬μ¤νΈλ΅ λ³€ν™ν•λ” λ…λ Ήμ–΄. column_stackκ³Όλ” λ‹¤λ¥΄κ² 1μ¤„λ΅ λ‚μ—΄ν•¨
```
π¨ μ£Όμ: column_stackκ³Ό concatenateλ” μ—°κ²°ν•  λ¦¬μ¤νΈλ‚ λ°°μ—΄μ„ νν”λ΅ μ „λ‹¬ν•΄μ•Ό ν•κΈ°μ— μ†κ΄„νΈλ¥Ό μ‚¬μ©.

β† **μ‚¬μ΄ν‚·λ°μΌλ΅ ν›λ ¨ μ„ΈνΈμ™€ ν…μ¤νΈ μ„ΈνΈ λ‚λ„κΈ°**
```python
from sklearn.model_selection import train_test_split #ν¨ν‚¤μ§€μ—μ„ νΉμ • ν΄λμ¤λ§ μ„ν¬νΈν•λ” λ…λ Ήμ–΄
train_input, test_input, train_target, test_target = train_test_split(fish_data, fish_target, stratify=fish_target random_state=μ •μ) #fish_dataμ λ°μ΄ν„°λ¥Ό train_inputκ³Ό test_inputμ—, fish_targetμ λ°μ΄ν„°λ¥Ό train_targetκ³Ό test_targetμ— λ¬΄μ‘μ„λ΅ λ‚λ„μ–΄ μ¤. stratifyλ¥Ό ν™μ©ν•΄ μƒν”λ§ νΈν–¥ λ°©μ§€. μΈλ±μ¤μ μ§€μ •μ΄ ν•„μ” μ—†μ
```

β† **μ΄μ›ƒ μƒν” μ°ΎκΈ°**
```python
distance, indexes = A.kneighbors([[μ‹¤μ, μ‹¤μ]]) #κ΄„νΈ μ•μ μƒν”κ³Ό κ°€μ¥ κ°€κΉμ΄ λ‹¤μ„― κ°μ μƒν”μ κ±°λ¦¬μ™€ μΈλ±μ¤λ¥Ό μ°Ύλ” λ…λ Ήμ–΄
```
π¨ μ£Όμ: μ‚°μ λ„λ΅ μ¶λ ¥ν•  κ²½μ° ν”„λ΅κ·Έλ¨μ μ¶λ ¥κ°’μ΄ μ΄ν•΄λμ§€ μ•μ„ μ μμ. μ΄λ” xμ¶•κ³Ό yμ¶•μ μ¤μΌ€μΌ μ°¨μ΄λ΅ λ°μƒ. xlim(())μ„ ν†µν•΄ λ‘ μ¶•μ λ²”μ„λ¥Ό λ™μΌν•κ² μ„¤μ •ν•  κ²½μ° μ΄ν•΄κ°€ λ¨.

β† **λ°μ΄ν„° μ „μ²λ¦¬**: k-μµκ·Όμ ‘ μ΄μ›ƒ μ•κ³ λ¦¬μ¦κ³Ό κ°™μ€ κ±°λ¦¬ κΈ°λ° μ•κ³ λ¦¬μ¦μ€ νΉμ„±κ°’μ„ μΌμ •ν• κΈ°μ¤€μΌλ΅ λ§μ¶”μ–΄μ•Ό μ λ€λ΅ μ‚¬μ© κ°€λ¥. μ΄λ° μ‘μ—…μ„ μλ―Έ.

π“ ν‘μ¤€μ μ: λ°μ΄ν„° μ „μ²λ¦¬ κ³Όμ •μ—μ„ μ£Όλ΅ ν™μ©ν•λ” λ°©λ²•μΌλ΅ ν‰κ· μ„ λΊ€ ν›„ ν‘μ¤€νΈμ°¨λ΅ λ‚λ„μ–΄ κµ¬ν•¨.
```python
mean = np.mean(train_input, axis=0) #ν‰κ· μ„ κ³„μ‚°ν•λ” λ…λ Ήμ–΄. μ΄λ• axisλ¥Ό 0μΌλ΅ μ„¤μ •ν•΄μ•Ό ν–‰μ„ λ”°λΌ κ° μ—΄μ ν†µκ³„ κ°’μ„ κ³„μ‚°ν•¨. μ¦‰ ν‰κ· μ΄ λ‘ κ° λ‚μ΄
std = np.std(train_iput, axis=0) #ν‘μ¤€νΈμ°¨λ¥Ό κ³„μ‚°ν•λ” λ…λ Ήμ–΄. μ΄λ• axisλ¥Ό 0μΌλ΅ μ„¤μ •ν•΄μ•Ό ν–‰μ„ λ”°λΌ κ° μ—΄μ ν†µκ³„ κ°’μ„ κ³„μ‚°ν•¨. μ¦‰ ν‘μ¤€νΈμ°¨κ°€ λ‘ κ° λ‚μ΄ 
train_scaled = (train_input - mean) / std #ν‘μ¤€μ μλ¥Ό κ³„μ‚°ν•λ” κ³„μ‚°μ‹. λ„νμ΄λ” μ•μ•„μ„ μ—΄μ„ κµ¬λ¶„ν•μ—¬ ν‰κ· μ„ λΉΌκ³  ν‘μ¤€νΈμ°¨λ¥Ό λ‚λ„μ–΄μ¤. μ΄λ¥Ό λΈλ΅λ“μΊμ¤ν…μ΄λΌ ν•¨
new = ([25,150] - mean) / std #ν…μ¤νΈν•  μƒν”μ ν‘μ¤€μ μλ¥Ό κ³„μ‚°ν•λ” κ³„μ‚°μ‹. λ„νμ΄λ” μ•μ•„μ„ μ—΄μ„ κµ¬λ¶„ν•μ—¬ ν‰κ· μ„ λΉΌκ³  ν‘μ¤€νΈμ°¨λ¥Ό λ‚λ„μ–΄μ¤
kn.fit(train_scaled, train_target) #k-μµκ·Όμ ‘ μ΄μ›ƒ μ•κ³ λ¦¬μ¦μ„ λ‹¤μ‹ ν›λ ¨μ‹ν‚¤λ” κ³Όμ •
test_scaled = (test_input - mean) / std #ν…μ¤νΈ μ„ΈνΈμ μ¤μΌ€μΌμ„ ν›λ ¨ μ„ΈνΈμ™€ λ™μΌν•κ² λ³€ν™ν•λ” κ³Όμ •
kn.score(test_scaled, test_target)
```
π¨ μ£Όμ: ν…μ¤νΈ μ„ΈνΈλ” ν›λ ¨ μ„ΈνΈμ ν‰κ· κ³Ό ν‘μ¤€νΈμ°¨λ¥Ό μ΄μ©ν•μ—¬ λ³€ν™ν•΄μ•Όν•¨. κ·Έλ¬μ§€ μ•μΌλ©΄ λ‘ μ„ΈνΈμ μ¤μΌ€μΌμ΄ λ‹¬λΌμ§.

