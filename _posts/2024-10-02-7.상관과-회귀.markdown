---
layout: post
title: "통계 101 X 데이터 분석 : 7. 상관과 회귀"
date: 2024-10-02 04:01:45 +0900
categories: 통계_101_X_데이터_분석
---
## <span style= 'background-color: #f1f8ff'>7-1. 양적 변수 사이의 관계를 밝히다
🗃️ 산점도\
1개 변수를 x축 값으로, 다른 1개 변수를 y축 값으로 하여 각 값을 2차원 평면 위 점으로 나타내어 그린 그래프.

🗃️ 상관\
두 변수 사이의 관계로 증가 관계, 감소 관계, 관계 없음이 있음. 양적 변수에 한정되지 않는 개념으로 2개의 확률변수 또는 데이터 사이의 관계성을 의미.
![image](https://github.com/user-attachments/assets/1d5d30e0-b056-4517-b995-7cb04be57990)

🗃️ 회귀\
y=f(x)라는 함수를 통해 변수 사이의 관계를 공식화하는 것. 이때 x를 설명변수 또는 독립변수, y를 반응변수 또는 종속변수라 함. **회귀분석**에서는 얻은 데이터에 잘 들어맞는 f(x)를 추정하고, 2개 변수 간 관계를 구함.
![image](https://github.com/user-attachments/assets/e5c6d838-0fd3-40b7-9528-8a0a0f39347d)


## <span style= 'background-color: #f1f8ff'>7-2. 상관관계
🗃️ 피어슨 상관계수\
2개의 양적 변수 간 관계의 강도를 정량화하는 방법으로 2개 양적 변수 사이의 선형관계가 얼마나 직선 관계에 가까운가를 평가함. 피어슨 상관계수 r의 범위는 **-1<=r<=1**이고, 공식은 다음과 같음.
![image](https://github.com/user-attachments/assets/2ce769af-b46f-40a5-8163-013e198f4554)

대표적인 산점도 예시와 그에 따른 r값은 다음과 같음.
![image](https://github.com/user-attachments/assets/2ee7f3ec-813c-4d6a-a011-5afcb3eacc4d)

부호가 양일 때는 x가 커질수록 y도 함께 커지고, x가 작아질수록 y도 함께 작아짐. 이를 **양의 상관**이라 함. 반대는 **음의 상관**이라 함. 

|r|값에 따른 상관의 강도는 다음과 같음.
![image](https://github.com/user-attachments/assets/f818302b-dc55-49da-90f9-6da2473f3afd)

피어슨 상관계수 r은 '선형'관계성 강도를 정량화한 것으로 비선형 관계성 정량화에는 적절하지 않음. 또 직선의 기울기 크기는 r에 영향을 미치지 않음.

또 r값이 같더라도 다양한 산점도 패턴을 보일 수 있기 때문에 상관계수만 보고서 산점도를 전형적인 우상향 그래프로 짐작하는 것은 위험.

피어슨 상관계수는 정규성이 있는 분포에만 적절하기에 실전에서는 상관계수를 계산하기 전에 x축 데이터와 y축 데이터 각각에 대해 정규성을 **샤피로-윌크 검정**등으로 확인한 다음 한쪽에 조금이라도 정규성이 없다면 비모수 상관계수를 이용하는 것이 좋음.

🗃️ 비모수 상관계수\
데이터의 x축과 y축 중 적어도 하나 이상에 정규성이 없을 때는 비모수 상관계수인 **스피어만 순위상관계수 p** 사용이 권장됨. 마찬가지로 -1부터 1까지의 실숫값임. 정의상 스피어만 순위상관계수 p는 양적 데이터의 값 자체가 아니라 그 데이터를 x축, y축 각각에서 크기 순으로 나열했을 때의 순위로 변환한 다음 아래 식을 이용해 계산함.
![image](https://github.com/user-attachments/assets/2ce769af-b46f-40a5-8163-013e198f4554)

유사한 값으로 **켄달 순위상관계수 t**가 있는데, 스피어만 순위상관계수 p와 사용 대상은 거의 비슷하나 표본크기가 매우 작을 때는 켄달 순위상관계수 t가 유의성검정의 관점에서 더 좋음.

🗃️ 상관관계 사용 시 주의할 점\
변수 하나는 X고 두 번째 변수는 X+Y인 것처럼 처음부터 두 변수가 종속 관계일 때는 주의가 필요함. X와 Y의 관계가 무상관이어도 X와 X+Y에는 무조건 상관이 나타나기 때문.

🗃️ 비선형상관\
X가 Y에 관해, 또는 Y가 X에 관해 어느 정도의 정보를 포함하는지의 관점에서 관계성 강도를 정량화하여 정보에 기반을 두고 생각하는 것이 비선형관계도 포함하는 일반적인 원리임.


## <span style= 'background-color: #f1f8ff'>7-3. 선형회귀
🗃️ 회귀 분석이란?\
표본의 회귀식으로부터 미지수인 모집단의 성질을 나타내는 파라미터를 추정하여 회귀모형을 얻어내는 과정. 회귀모형은 다음과 같음.
![image](https://github.com/user-attachments/assets/b20c3388-97ea-4032-9231-a91e9b5f76ab)

🗃️ 최소제곱법\
회귀모형의 a와 b를 결정하는 방법 중 하나로 데이터와 모형 차이의 제곱을 모두 더한 값 E를 최소화하는 방법.
![image](https://github.com/user-attachments/assets/f201c25c-89d6-4ee8-8d05-fc6d4dfd9c12)

🗃️ 최량선형비편향추정량\
최소제곱법으로 얻은 추정량으로 비편향추정량 중에서도 가장 정밀도가 높은 비편향추정량.

🗃️ 신뢰구간과 예측구간\
신뢰구간은 모집단의 범위, 예측구간은 얻을 수 있는 데이터의 범위를 나타냄.
![image](https://github.com/user-attachments/assets/0086c7b0-f0e8-4acd-a8c3-9b05f26040ea)

🗃️ 결정계수 R^2\
회귀식이 잘 들어맞는지 평가하는 지표로 정의는 다음과 같음.
![image](https://github.com/user-attachments/assets/3dbc458d-109d-4f8b-81bf-37d76a71e5e4)
우변 제2항의 분모가 반응변수 전체의 분산을 나타내며, 분자는 회귀모형과 실제 데이터의 잔차를 제곱한 것의 총합으로 최소제곱법에서 봤던 E를 나타냄. 즉 우변 제2항은 잔차의 비율을 표시하고, 이에 따라 결정계수 R^2은 데이터에 의해 설명된 비율을 나타냄. 이것이 1에 가까울수록 회귀모형이 데이터에 잘 들어맞음을 의미.
![image](https://github.com/user-attachments/assets/c57a6142-c6b0-4a33-92d2-721e7a448e17)
그러나 결정계수 R^2은 설명변수의 개수가 늘어날수록 커지는 성질이 있어서 의미 없는 설명변수를 도입해도 설명력이 향상된 것처럼 나타나기도 함. 따라서 설명변수 개수 k에 따라 조정한 **조정 결정계수 R'^2**을 사용하는 것이 일반적. 정의는 다음과 같음.
![image](https://github.com/user-attachments/assets/bde7ca94-7db0-4b95-8c11-79dc17f566e4)

🗃️ 오차의 등분산성과 정규성\
최소제곱법으로 구한 선형모형의 파라미터를 대상으로 가설검정을 시행하거나 신뢰구간을 얻기 위해서는 오차항의 확률분포가 정규분포라고 가정해야 함. 설명변수와 반응변수가 정규분포일 필요는 없음. 설명변수의 값에 따라 오차의 분산이 변하지 않는다고 가정하면 최소제곱법에 따른 선형회귀모형의 추정으로 최량선형비편향추정량을 얻을 수 있음. 등분산성을 확인하려면 설명변수가 변할 때 잔차의 분산이 달라지는지를 조사하는 **브루쉬-페이건 검정**을 이용함.
![image](https://github.com/user-attachments/assets/1e6e0700-e79d-43b2-ae22-f3cb0148cbea)

🗃️ 설명변수와 반응변수
1. 한쪽 변수로 다른 한쪽 변수를 설명하고자 할 때: 설명하는 쪽을 설명변수로 설명할 대상을 반응변수로 설정. 이때 설명은 x와 y 사이에 어떠한 관계가 있음을 시사한다고 생각하면 좋음.
2. 인과효과를 알고 싶을 때: 원인을 설명변수로 결과를 반응변수로 설정. 인과효과를 올바르게 추정하기 위해서는 서로 다른 x에 대해 그 밖의 요인이 같아야 함. 따라서 설명변수를 무작위로 할당한 개입 실험에서 얻은 데이터나 상정할 수 있는 다른 요인도 포함한 다중회귀모형 등을 이용하는 것이 필요.
3. 데이터를 예측하고 싶을 때: 예측의 근거가 될 변수를 설명변수, 예측하고자 하는 변수를 반응변수로 설정. 그럼 회귀분석의 결과로 얻은 회귀모형에 새롭게 얻은 설명변수 값을 대입하여 반응변수 값을 예측할 수 있음.


### 출처 : 통계 101 X 데이터 분석