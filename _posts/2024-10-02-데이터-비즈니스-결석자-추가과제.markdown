---
layout: post
title: "ë°ì´í„° ë¹„ì¦ˆë‹ˆìŠ¤ & ì¶”ì²œ ì‹œìŠ¤í…œ: ê²°ì„ì ì¶”ê°€ê³¼ì œ"
date: 2024-10-02 04:01:45 +0900
categories: ë°ì´í„°_ë¹„ì¦ˆë‹ˆìŠ¤_&_ì¶”ì²œ_ì‹œìŠ¤í…œ
---
## <span style= 'background-color: #f1f8ff'>ì˜ì‚¬ê²°ì • íŠ¸ë¦¬ ëª¨ë¸ì˜ ê³¼ì í•© í•´ê²°ë²•
ğŸ” "ì´ëŸ° ê²½ìš°ì—ëŠ” **ë°ì´í„° ëŠ˜ë¦¬ê¸°**, **ë³€ìˆ˜ ì¬ê²€í† **, **ëª¨ë¸ì˜ íŒŒë¼ë¯¸í„° ë³€ê²½**ê³¼ ê°™ì€ ë°©ë²•ì„ ì ìš©í•´ ê°€ë©´ì„œ ì´ìƒì ì¸ ëª¨ë¸ë¡œ ë§Œë“¤ì–´ ê°‘ë‹ˆë‹¤." - íŒŒì´ì¬_ë°ì´í„°ë¶„ì„_ì‹¤ë¬´_í…Œí¬ë‹‰_100(122p)

ğŸ—ƒï¸ ê³¼ì í•©: ê¸°ê³„ í•™ìŠµì—ì„œ í•™ìŠµ ë°ì´í„°ë¥¼ ê³¼í•˜ê²Œ í•™ìŠµí•˜ëŠ” ê²ƒì„ ëœ»í•¨. ì¼ë°˜ì ìœ¼ë¡œ í•™ìŠµ ë°ì´í„°ëŠ” ì‹¤ì œ ë°ì´í„°ì˜ ë¶€ë¶„ ì§‘í•©ì´ë¯€ë¡œ ê³¼ì í•©ì´ ë°œìƒí•  ê²½ìš° í•™ìŠµ ë°ì´í„°ì— ëŒ€í•´ì„œëŠ” ì˜¤ì°¨ê°€ ê°ì†Œí•˜ì§€ë§Œ ì‹¤ì œ ë°ì´í„°ì— ëŒ€í•´ì„œëŠ” ì˜¤ì°¨ê°€ ì¦ê°€í•˜ê²Œ ëœë‹¤.

ğŸ—ƒï¸ ì˜ì‚¬ê²°ì • íŠ¸ë¦¬ ëª¨ë¸ì˜ ê³¼ì í•© í•´ê²°ë²•
â‘  ë°ì´í„° ëŠ˜ë¦¬ê¸°: ëª¨ë¸ì´ ë” ë‹¤ì–‘í•œ ë°ì´í„°ë¥¼ í†µí•´ í•™ìŠµí•˜ë©´ ì¼ë°˜í™” ëŠ¥ë ¥ì´ í–¥ìƒë  ìˆ˜ ìˆìŒ. **ë°ì´í„° ì¶”ê°€ ìˆ˜ì§‘**, **ë°ì´í„° ì¦ê°•**ì˜ ë°©ì‹ì„ ì´ìš©í•´ í›ˆë ¨ ë°ì´í„°ë¥¼ ëŠ˜ë¦´ ìˆ˜ ìˆìŒ.

â ë³€ìˆ˜ ì¬ê²€í† : ë¶ˆí•„ìš”í•˜ê±°ë‚˜ ê´€ë ¨ì„±ì´ ë‚®ì€ ë³€ìˆ˜ë¥¼ í¬í•¨í•˜ë©´ ëª¨ë¸ì´ í•™ìŠµ ë°ì´í„°ì˜ ë…¸ì´ì¦ˆë¥¼ í•™ìŠµí•˜ê²Œ ë˜ì–´ ê³¼ì í•©ì´ ë°œìƒí•  ìˆ˜ ìˆìŒ. ë¶ˆí•„ìš”í•œ ë³€ìˆ˜ë¥¼ ì œê±°í•˜ê¸° ìœ„í•´ **ìƒê´€ ë¶„ì„**, **ë³€ìˆ˜ ì¤‘ìš”ë„ í‰ê°€**, ë“±ì„ í™œìš©í•  ìˆ˜ ìˆìŒ.

â€ ìƒê´€ ë¶„ì„: ë³€ìˆ˜ë“¤ ê°„ì˜ ìƒê´€ê´€ê³„ë¥¼ ë¶„ì„í•˜ì—¬ ìƒê´€ì„±ì´ ë‚®ì€ ë³€ìˆ˜ëŠ” ì œê±°.\
â ë³€ìˆ˜ ì¤‘ìš”ë„ í‰ê°€: ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ê° ë³€ìˆ˜ì˜ ì¤‘ìš”ë„ë¥¼ í‰ê°€.
```python
importance = pd.DataFrame({"feature_names": X.columns, "coefficient": model.feature_importances_ })
importance
```
![image](https://github.com/user-attachments/assets/82449944-2452-4815-8c66-1210049539fc)

â¡ï¸ ê¸°ì—¬ë„ê°€ ë‚®ì€ ë³€ìˆ˜ë“¤ì„ ì§€ìš°ê³  ì¬í›ˆë ¨ í•´ë³´ì•˜ì§€ë§Œ ì—¬ì „íˆ ê³¼ì í•© ë°œìƒ.(í•´ë‹¹ ì˜ˆì œì—ì„œ í° ì˜ë¯¸ ì—†ëŠ” ë°©ë²•)

â‚ í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹(ê°€ì§€ì¹˜ê¸°): **ìµœëŒ€ ê¹Šì´**, **ìµœì†Œ ìƒ˜í”Œ ë¶„í•  ìˆ˜**, **ìµœì†Œ ë¦¬í”„ ë…¸ë“œ ìˆ˜** ë“±ì„ ì¡°ì •í•˜ì—¬ ê³¼ì í•© í•´ê²°.
```python
#ìµœì†Œ ìƒ˜í”Œ ë¶„í•  ìˆ˜ ìˆ˜ì •

X = pd.concat([exit, conti], ignore_index=True)
y = X["is_deleted"]
del X["is_deleted"]
X_train, X_test, y_train, y_test = sklearn.model_selection.train_test_split(X,y)

model = DecisionTreeClassifier(min_samples_split=95,random_state=0)
model.fit(X_train, y_train)
print(model.score(X_test, y_test))
print(model.score(X_train, y_train))
```
0.9049429657794676\
0.9157160963244614

```python
#ìµœì†Œ ë¦¬í”„ ë…¸ë“œ ìˆ˜ ì¡°ì •

X = pd.concat([exit, conti], ignore_index=True)
y = X["is_deleted"]
del X["is_deleted"]
X_train, X_test, y_train, y_test = sklearn.model_selection.train_test_split(X,y)

model = DecisionTreeClassifier(min_samples_leaf=5,random_state=0)
model.fit(X_train, y_train)
print(model.score(X_test, y_test))
print(model.score(X_train, y_train))
```
0.935361216730038\
0.9359949302915083

âƒ êµì°¨ ê²€ì¦: ê²€ì¦ ì„¸íŠ¸ë¥¼ ë–¼ì–´ë‚´ì–´ í‰ê°€í•˜ëŠ” ê³¼ì •ì„ ì—¬ëŸ¬ ë²ˆ ë°˜ë³µ. ê·¸ ë‹¤ìŒ ì´ ì ìˆ˜ë¥¼ í‰ê· í•˜ì—¬ ìµœì¢… ê²€ì¦ ì ìˆ˜ë¥¼ ì–»ìŒ.
```python
X = pd.concat([exit, conti], ignore_index=True)
y = X["is_deleted"]
del X["is_deleted"]
X_train, X_test, y_train, y_test = sklearn.model_selection.train_test_split(X,y)

model = DecisionTreeClassifier(random_state=0)
from sklearn.model_selection import cross_validate
scores = cross_validate(model, X_train, y_train, cv=10, return_train_score=True)

import numpy as np
print(np.mean(scores['test_score']))
print(np.mean(scores['train_score']))
```
0.892892848504394\
0.9819038368139875

â„ ëœë¤ í¬ë ˆìŠ¤íŠ¸: ì•™ìƒë¸” í•™ìŠµì˜ ëŒ€í‘œ ì£¼ì ì¤‘ í•˜ë‚˜ë¡œ ì•ˆì •ì ì¸ ì„±ëŠ¥ ë•ë¶„ì— ë„ë¦¬ ì‚¬ìš©ë¨. ê²°ì • íŠ¸ë¦¬ë¥¼ ëœë¤í•˜ê²Œ ë§Œë“¤ì–´ ê²°ì • íŠ¸ë¦¬ì˜ ìˆ²ì„ ë§Œë“¤ê³  ê° ê²°ì • íŠ¸ë¦¬ì˜ ì˜ˆì¸¡ì„ ì‚¬ìš©í•´ ìµœì¢… ì˜ˆì¸¡ì„ ë§Œë“¦. ê¸°ë³¸ì ìœ¼ë¡œ 100ê°œì˜ ê²°ì • íŠ¸ë¦¬ë¥¼ í›ˆë ¨í•¨.
```python
X = pd.concat([exit, conti], ignore_index=True)
y = X["is_deleted"]
del X["is_deleted"]
X_train, X_test, y_train, y_test = sklearn.model_selection.train_test_split(X,y)

model = DecisionTreeClassifier(random_state=0)
from sklearn.model_selection import cross_validate
from sklearn.ensemble import RandomForestClassifier
rf = RandomForestClassifier(n_jobs=-1, random_state=42)
scores = cross_validate(rf, X_train, y_train, return_train_score=True, n_jobs=-1) 

print(np.mean(scores['test_score']))
print(np.mean(scores['train_score']))
```
0.9169821177416114\
0.987643060506705