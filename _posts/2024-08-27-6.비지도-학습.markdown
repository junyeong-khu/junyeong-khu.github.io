---
layout: post
title: "í˜¼ì ê³µë¶€í•˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹+ë”¥ëŸ¬ë‹ : 6. ë¹„ì§€ë„ í•™ìŠµ"
date: 2024-08-27 03:01:45 +0900
categories: í˜¼ì_ê³µë¶€í•˜ëŠ”_ë¨¸ì‹ ëŸ¬ë‹+ë”¥ëŸ¬ë‹
---
## <span style= 'background-color: #f1f8ff'>6-1: êµ°ì§‘ ì•Œê³ ë¦¬ì¦˜
**â˜† ë¹„ì§€ë„ í•™ìŠµ: íƒ€ê¹ƒì´ ì—†ì„ ë•Œ ì‚¬ìš©í•˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜. ì‚¬ëŒì´ ê°€ë¥´ì³ ì£¼ì§€ ì•Šì•„ë„ ë°ì´í„°ì— ìˆëŠ” ë¬´ì–¸ê°€ë¥¼ í•™ìŠµí•˜ëŠ” ì•Œê³ ë¦¬ì¦˜.**

**â˜† êµ°ì§‘ ì•Œê³ ë¦¬ì¦˜: ë¹„ìŠ·í•œ ìƒ˜í”Œë¼ë¦¬ ê·¸ë£¹ìœ¼ë¡œ ëª¨ì•„ í•™ìŠµí•˜ëŠ” ì•Œê³ ë¦¬ì¦˜.**

â€ ê³¼ì¼ ì‚¬ì§„ ë°ì´í„° ì¤€ë¹„
```python
#ê³¼ì¼ ì‚¬ì§„ ë°ì´í„° ì¤€ë¹„ ë‹¨ê³„ì—ì„œ ì‚¬ìš©ë˜ëŠ” ì½”ë“œ

!wget https://bit.ly/fruits_300 -0 fruits_300.npy #npy íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œ í•˜ëŠ” ëª…ë ¹ì–´

import numpy as np
import matplotlib.pyplot as plt

fruits = np.load('fruits_300.npy') #ë„˜íŒŒì´ì—ì„œ npy íŒŒì¼ì„ ë¡œë“œí•˜ëŠ” ëª…ë ¹ì–´

print(fuits.shape) #ë°°ì—´ì˜ í¬ê¸°ë¥¼ í™•ì¸í•˜ëŠ” ëª…ë ¹ì–´. ì²« ë²ˆì§¸ ì°¨ì›ì€ ìƒ˜í”Œì˜ ê°œìˆ˜, ë‘ ë²ˆì§¸ ì°¨ì›ì€ ì´ë¯¸ì§€ ë†’ì´, ì„¸ ë²ˆì§¸ ì°¨ì›ì€ ì´ë¯¸ì§€ ë„ˆë¹„ë¥¼ ë‚˜íƒ€ëƒ„

print(fruits[0, 0, :]) #ì²« ë²ˆì§¸ ì´ë¯¸ì§€ì˜ ì²« ë²ˆì§¸ í–‰ì„ ì¶œë ¥í•˜ëŠ” ëª…ë ¹ì–´. í‘ë°± ì‚¬ì§„ì„ ë‹´ê³  ìˆê¸°ì— 0~255ê¹Œì§€ì˜ ì •ìˆ«ê°’ì„ ê°€ì§

plt.imshow(fruits[0], cmap='gray') #ë„˜íŒŒì´ ë°°ì—´ë¡œ ì €ì¥ëœ ì´ë¯¸ì§€ë¥¼ ê·¸ë¦¬ëŠ” ëª…ë ¹ì–´. í‘ë°± ì´ë¯¸ì§€ë¼ cmapì„ grayë¡œ ì§€ì •
plt.show()
```
ğŸ“Œ 0~255ê¹Œì§€ì˜ ì •ìˆ«ê°’ì˜ ì˜ë¯¸: 0ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ê²€ê²Œ ë‚˜íƒ€ë‚˜ê³ , ë†’ì€ ê°’ì€ ë°ê²Œ ë‚˜íƒ€ë‚¨. ì´ë•Œ í”½ì…€ê°’ì´ ë†’ìœ¼ë©´ ì¶œë ¥ê°’ë„ ì»¤ì§€ê¸°ì— ì»´í“¨í„°ëŠ” ìˆ˜ê°€ ì»¤ì§ˆìˆ˜ë¡ ì§‘ì¤‘í•¨. cmapì„ gray_rë¡œ ì§€ì •í•˜ë©´ ë°˜ëŒ€ë¡œ ë‚˜íƒ€ë‚˜ëŠ”ë°, ì´ë•ŒëŠ” ë°ì€ ë¶€ë¶„ì´ 0ì— ê°€ê¹Œì›€.

â í”½ì…€ê°’ ë¶„ì„
```python
#í”½ì…€ê°’ ë¶„ì„ì—ì„œ ì‚¬ìš©ë˜ëŠ” ì½”ë“œ

apple = fruits[0:100].reshape(-1, 100*100) #ì²˜ìŒ ìƒ˜í”Œë¶€í„° 100ë²ˆì§¸ ìƒ˜í”Œê¹Œì§€ ì„ íƒ í›„, ë‘ ë²ˆì§¸ ì°¨ì›ê³¼ ì„¸ ë²ˆì§¸ ì°¨ì›ì„ í•©ì¹˜ëŠ” ëª…ë ¹ì–´
pineapple = fruits[100:200].reshape(-1, 100*100)
banana = fruits[200:300].reshape(-1, 100*100)

print(apple.mean(axis=1)) #í”½ì…€ í‰ê· ê°’ì„ ê³„ì‚°í•˜ëŠ” ëª…ë ¹ì–´. axis=1ë¡œ ì§€ì •í•˜ì—¬ ì—´ ë°©í–¥ìœ¼ë¡œ ê³„ì‚°í•˜ê²Œë” ì„¤ì •

plt.hist(np.mean(apple, axis=1), alpha=0.8) #íˆìŠ¤í† ê·¸ë¨ì„ ê·¸ë¦¬ëŠ” ëª…ë ¹ì–´. alphaë¥¼ 1ë³´ë‹¤ ì‘ê²Œ ì„¤ì •í•˜ì—¬ íˆ¬ëª…ë„ë¥¼ ì„¤ì •í•¨
plt.hist(np.mean(pineapple, axis=1), alpha=0.8)
plt.hist(np.mean(banana, axis=1), alpha=0.8)

plt.legend(['apple', 'pineapple', 'banana']) #ì–´ë–¤ ê³¼ì¼ì˜ íˆìŠ¤í† ê·¸ë¨ì¸ì§€ ë²”ë¡€ë¥¼ ë§Œë“œëŠ” ëª…ë ¹ì–´
plt.show()
```
â¡ï¸
![image](https://github.com/user-attachments/assets/b6113a3c-51b2-4fa4-8412-fd665a8662e4)

```python
#í”½ì…€ê°’ ë¶„ì„ì—ì„œ ìƒ¤ìš©ë˜ëŠ” ì½”ë“œ

fig, axs = plt.subplots(1, 3, figsize=(20,5)) #3ê°œì˜ ì„œë¸Œ ê·¸ë˜í”„ë¥¼ ë§Œë“œëŠ” ëª…ë ¹ì–´
axs[0].bar(range(10000), np.mean(apple, axis=0))
axs[1].bar(range(10000), np.mean(pineapple, axis=0))
axs[2].bar(range(10000), np.mean(banana, axis=0))
plt.show()
```
â¡ï¸
![image](https://github.com/user-attachments/assets/7577a202-a53d-4b2b-a077-47a6deb77ea4)

```python
#í”½ì…€ê°’ ë¶„ì„ì—ì„œ ìƒ¤ìš©ë˜ëŠ” ì½”ë“œ

apple_mean = np.mean(apple, axis=0).reshape(100, 100)
pineapple_mean = np.mean(pineapple, axis=0).reshape(100, 100)
banana_mean = np.mean(banana, axis=0).reshape(100, 100)
fig, axs = plt.subplots(1, 3, figsize=(20,5))
axs[0].imshow(apple_mean, cmap='gray_r')
axs[1].imshow(pinneapple_mean, cmap='gray_r')
axs[2].imshow(banana_mean, cmap='gray_r')
plt.show()
```
â¡ï¸
![image](https://github.com/user-attachments/assets/be6da55a-51df-4e69-8107-8f9919b6390b)

â‚ í‰ê· ê°’ê³¼ ê°€ê¹Œìš´ ì‚¬ì§„ ê³ ë¥´ê¸°

```python
#í‰ê· ê°’ê³¼ ê°€ê¹Œìš´ ì‚¬ì§„ ê³ ë¥´ê¸°ì—ì„œ ì‚¬ìš©ë˜ëŠ” ì½”ë“œ

abs_diff = np.abs(fruits - apple_mean) #ëª¨ë“  ìƒ˜í”Œì—ì„œ apple_meanì„ ëº€ ì ˆëŒ“ê°’ì„ ê³„ì‚°
abs_mean = np.mean(abs_diff, axis=(1,2))
print(abs_mean.shape)

apple_index = np.argsort(abs_mean)[:100] #ì˜¤ì°¨ê°€ ì‘ì€ ìƒ˜í”Œ 100ê°œë¥¼ ê³ ë¥´ëŠ” ëª…ë ¹ì–´
fig, axs = plt.subplots(10, 10, figsize=(10,10))
for i in range(10):
    for j in range(10):
        axs[i, j].imshow(fruits[apple_index[i*10 + j]], cmap='gray_r')
        axs[i, j].axis('off')
plt.show()
```
â¡ï¸
![image](https://github.com/user-attachments/assets/0a86cc1e-e471-4509-b288-569114598edc)

ğŸ“Œ í´ëŸ¬ìŠ¤í„°: êµ°ì§‘ ì•Œê³ ë¦¬ì¦˜ì—ì„œ ë§Œë“  ê·¸ë£¹.

## <span style= 'background-color: #f1f8ff'>6-2: k-í‰ê· 
**â˜† k-í‰ê·  ì•Œê³ ë¦¬ì¦˜: ì¤€ë¹„ëœ ìƒ˜í”Œì— ì–´ë–¤ ì •ë³´ê°€ ìˆëŠ”ì§€ ì•Œì§€ ëª»í•  ë•Œ í‰ê· ê°’ì„ êµ¬í•˜ëŠ” êµ°ì§‘ ì•Œê³ ë¦¬ì¦˜.**

**â˜† k-í‰ê·  ì•Œê³ ë¦¬ì¦˜ì˜ ì‘ë™ ë°©ì‹**
1. ë¬´ì‘ìœ„ë¡œ kê°œì˜ í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬ì„ ì •í•œë‹¤.
2. ê° ìƒ˜í”Œì—ì„œ ê°€ì¥ ê°€ê¹Œìš´ í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬ì„ ì°¾ì•„ í•´ë‹¹ í´ëŸ¬ìŠ¤í„°ì˜ ìƒ˜í”Œë¡œ ì§€ì •í•œë‹¤.
3. í´ëŸ¬ìŠ¤í„°ì— ì†í•œ ìƒ˜í”Œì˜ í‰ê· ê°’ìœ¼ë¡œ í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬ì„ ë³€ê²½í•œë‹¤.
4. í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬ì— ë³€í™”ê°€ ì—†ì„ ë•Œê¹Œì§€ 2ë²ˆìœ¼ë¡œ ëŒì•„ê°€ ë°˜ë³µí•œë‹¤.

![image](https://github.com/user-attachments/assets/d341e3fe-246a-4c99-9268-7382bbd3d0a0)

â¬†ï¸ k-í‰ê·  ì•Œê³ ë¦¬ì¦˜ì˜ ì‘ë™ ë°©ì‹

**â˜† KMeans í´ë˜ìŠ¤**
```python
#KMeans í´ë˜ìŠ¤ ì‹¤ìŠµ

!wget https://bit.ly/fruits_300 -0 fruits_300.npy

import numpy as np
fruits = np.load('fruits_300.npy')
fruits_2d = fruits.reshpe(-1, 100*100) #3ì°¨ì› ë°°ì—´ì„ 2ì°¨ì›ìœ¼ë¡œ ë³€ê²½

from sklearn.cluster import KMeans
km = KMeans(n_clusters=3, random_state=42) #n_clustersë¡œ í´ëŸ¬ìŠ¤í„° ê°œìˆ˜ ì„¤ì •
km.fit(fruits_2d) #ë¹„ì§€ë„ í•™ìŠµì´ê¸°ì— íƒ€ê¹ƒê°’ì„ ì œê³µí•˜ì§€ ì•ŠìŒ

print(km.labels_) #ê° ìƒ˜í”Œì´ ì–´ë–¤ ë ˆì´ë¸”ì— í•´ë‹¹í•˜ëŠ”ì§€ ì¶œë ¥í•˜ëŠ” ëª…ë ¹ì–´
```
â¡ï¸
![image](https://github.com/user-attachments/assets/da723891-bad1-417a-aa03-958609c59bcf)

```python
#KMeans í´ë˜ìŠ¤ ì‹¤ìŠµ

print(np.unique(km.labels_, return_counts=True))
```
â¡ï¸ (array([0, 1, 2], dtype=int32), array([91, 98, 111]))

```python
#KMeans í´ë˜ìŠ¤ ì‹¤ìŠµ (ê° í´ëŸ¬ìŠ¤í„°ê°€ ë‚˜íƒ€ë‚´ëŠ” ì´ë¯¸ì§€ ê·¸ë¦¼ìœ¼ë¡œ ì¶œë ¥)

import matplotlib.pyplot as plt
def draw_fruits(arr, ratio=1):
    n = len(arr)
    rows = int(np.ceil(n/10)) #í•œ ì¤„ì— 10ê°œì”© ì´ë¯¸ì§€ë¥¼ ê·¸ë¦¼. ìƒ˜í”Œ ê°œìˆ˜ë¥¼ 10ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ì „ì²´ í–‰ ê°œìˆ˜ë¥¼ ê³„ì‚°
    cols = n if rows < 2 else 10
    fig, axs = plt.subplots(rows, cols, figsize=(cols*ratio, rows*ratio), squeeze=False)
    for i in range(rows):
        for j in range(cols):
            if i*10 + j < n:
                axs[i, j].imshow(arr[i*10 + j], cmap='gray_r')
            axs[i, j].axis('off')
    plt.show()
```

**â˜† í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬**
```python
#í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬ê³¼ ê´€ë ¨í•œ ëª…ë ¹ì–´

print(km.n_iter_) #ì•Œê³ ë¦¬ì¦˜ì˜ ë°˜ë³µ íšŸìˆ˜ë¥¼ ì¶œë ¥í•˜ëŠ” ëª…ë ¹ì–´
```

**â˜† ìµœì ì˜ k ì°¾ê¸° : êµì¬ì—ì„œëŠ” í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬ê³¼ ìƒ˜í”Œë“¤ ì‚¬ì´ì˜ ê±°ë¦¬ì˜ ì œê³± í•©ì¸ ì´ë„ˆì…”ë¥¼ ì´ìš©í•˜ì—¬ ìµœì ì˜ kë¥¼ ì°¾ëŠ” ì—˜ë³´ìš° ë°©ì‹ì„ ì‚¬ìš©.**

```python
#ìµœì ì˜ k ì°¾ê¸°ì—ì„œ ì‚¬ìš©ë˜ëŠ” ëª…ë ¹ì–´

inertia = []
for k in range(2, 7):
    km = KMeans(n_clusters=k, random_state=42)
    km.fit(fruits_2d)
    inertia.append(km.inertia_)
plt.plot(range(2, 7), inertia)
plt.show()
```
â¡ï¸
![image](https://github.com/user-attachments/assets/132beaff-2d9d-43d0-82f8-93ae13758f00)

## <span style= 'background-color: #f1f8ff'>6-3: ì£¼ì„±ë¶„ ë¶„ì„
**â˜† ì°¨ì›ê³¼ ì°¨ì› ì¶•ì†Œ: ë¨¸ì‹ ëŸ¬ë‹ì—ì„œëŠ” íŠ¹ì„±ì„ ì°¨ì›ì´ë¼ê³ ë„ ë¶€ë¦„. ì´ë•Œ ì°¨ì›ì„ ì¶•ì†Œì‹œí‚¤ë©´ ì €ì¥ ê³µê°„ì„ í¬ê²Œ ì ˆì•½í•  ìˆ˜ ìˆëŠ”ë°, ë°ì´í„°ë¥¼ ê°€ì¥ ì˜ ë‚˜íƒ€ë‚´ëŠ” ì¼ë¶€ íŠ¹ì„±ì„ ì„ íƒí•˜ì—¬ ë°ì´í„° í¬ê¸°ë¥¼ ì¤„ì´ê³  ì§€ë„ í•™ìŠµ ëª¨ë¸ì˜ ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¤ëŠ” ë°©ë²•ì„ ì°¨ì› ì¶•ì†Œë¼ê³  í•¨.**

**â˜† ì£¼ì„±ë¶„ ë¶„ì„: ë°ì´í„°ì— ìˆëŠ” ë¶„ì‚°ì´ í° ë²¡í„°ì¸ ì£¼ì„±ë¶„ ë²¡í„°ë¥¼ ì°¾ëŠ” ê²ƒ. ì´ë•Œ ì£¼ì„±ë¶„ ë²¡í„°ì˜ ì›ì†Œ ê°œìˆ˜ëŠ” ì›ë³¸ ë°ì´í„°ì…‹ì— ìˆëŠ” íŠ¹ì„± ê°œìˆ˜ì™€ ê°™ìŒ.**

ğŸ“Œ ì£¼ì„±ë¶„ì˜ ê°œìˆ˜: ì¼ë°˜ì ìœ¼ë¡œ ì£¼ì„±ë¶„ì€ ì›ë³¸ íŠ¹ì„±ì˜ ê°œìˆ˜ë§Œí¼ ì°¾ì„ ìˆ˜ ìˆìŒ.

![image](https://github.com/user-attachments/assets/77490050-9fe1-4599-9495-624f39873252)

â¬†ï¸ ì£¼ì„±ë¶„ ë¶„ì„ì˜ ì›ë¦¬. ì£¼ì„±ë¶„ìœ¼ë¡œ ë°”ê¾¼ ë°ì´í„°ëŠ” ì°¨ì›ì´ ì¤„ì–´ë“¦.

**â˜† PCA í´ë˜ìŠ¤**
```python
#PCA í´ë˜ìŠ¤ ì‹¤ìŠµ

!wget https://bit.ly/fruits_300 -0 fruits_300.npy
import numpy as np
fruits = np.load('fruits_300.npy')
fruits_2d = fruits.reshape(-1, 100*100)

from sklearn.decomposition import PCA
pca = PCA(n_components=50) #ì£¼ì„±ë¶„ì˜ ê°œìˆ˜ ì§€ì •
pca.fit(fruits_2d)

draw_fruits(pca.components_.reshape(-1, 100, 100))
```
â¡ï¸
![image](https://github.com/user-attachments/assets/fa02ddec-6798-421e-a9bd-b3cb00fcbf23)

```python
#PCA í´ë˜ìŠ¤ ì‹¤ìŠµ

fruits_pca = pca.transform(fruits_2d) #ì°¨ì› ì¶•ì†Œ
print(fruits_pca.shape)
```
â¡ï¸ (300,50)

**â˜† ì›ë³¸ ë°ì´í„° ì¬êµ¬ì„±**
```python
#ì›ë³¸ ë°ì´í„° ì¬êµ¬ì„±ì—ì„œ ì‚¬ìš©ë˜ëŠ” ì½”ë“œ

fruits_invers = pca.invers_transform(fruits_pca)
print(fruits_inverse.shape)
```
â¡ï¸ (300, 10000)

**â˜† ì„¤ëª…ëœ ë¶„ì‚°: ì£¼ì„±ë¶„ì´ ì›ë³¸ ë°ì´í„°ì˜ ë¶„ì‚°ì„ ì–¼ë§ˆë‚˜ ì˜ ë‚˜íƒ€ë‚´ëŠ”ì§€ ê¸°ë¡í•œ ê°’.**

```python
print(np.sum(pca.explained_variance_ratio_)) #50ê°œì˜ ì£¼ì„±ë¶„ìœ¼ë¡œ í‘œí˜„í•˜ê³  ìˆëŠ” ì´ ë¶„ì‚° ë¹„ìœ¨ì„ ì¶œë ¥
```
â¡ï¸ 0.9215190262621741

```python
plt.plot(pca.explained_variance_ratio_) #ì„¤ëª…ëœ ë¶„ì‚°ì„ ê·¸ë˜í”„ë¡œ ì¶œë ¥
```
â¡ï¸
![image](https://github.com/user-attachments/assets/bc6b32bd-d65d-4230-ac5f-ef582872398d)


### ì¶œì²˜ : í˜¼ì ê³µë¶€í•˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹+ë”¥ëŸ¬ë‹